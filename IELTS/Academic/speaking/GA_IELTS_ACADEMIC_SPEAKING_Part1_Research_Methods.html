<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Academic Speaking Part 1: Research Methods Practice | Gammapace</title>

    <style>
        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Century Gothic', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(139, 69, 19, 0.2) 50%, rgba(255, 215, 0, 0.1) 100%);
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(139, 69, 19, 0.05) 0%, transparent 50%);
            z-index: -1;
            pointer-events: none;
        }

        /* Header spacing */
        .header-spacer {
            height: 20px;
            width: 100%;
        }

        /* Guruvammal Logo as Back Button - Right Side */
        .gk-logo-container {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1002;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }

        /* Master Guruvammal Logo for template back button */
        .master-guruvammal-logo {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            box-sizing: border-box;
            font-family: 'Century Gothic', sans-serif;
            font-size: 26px;
            font-weight: 900;
            letter-spacing: -1px;
            line-height: 1;
            color: #5d3a0a;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(139, 69, 19, 0.25) 50%, rgba(205, 133, 63, 0.2) 100%);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.3), 0 0 40px rgba(212, 175, 55, 0.2);
            z-index: 10000;
            transition: all 0.3s ease;
        }

        .master-guruvammal-logo .musical-corner {
            position: absolute;
            top: 3px;
            right: 4px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: transparent;
            border: 1px solid #5d3a0a;
            color: #5d3a0a;
            font-family: 'Century Gothic', sans-serif;
            font-size: 7px;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            box-shadow: none;
        }

        .master-guruvammal-logo:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(139, 69, 19, 0.4), 0 0 50px rgba(212, 175, 55, 0.3);
        }

        .back-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #8b4513;
            font-family: 'Century Gothic', sans-serif;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
            text-align: center;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover .back-label {
            color: #5d3a0a;
            transform: translateY(-1px);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            margin-left: 360px;
            transition: margin-left 0.3s ease;
        }

        .container.menu-collapsed {
            margin-left: 20px;
        }

        /* Main Content */
        .main-content {
            margin-top: 0;
            padding: 1.5rem 2rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Menu Toggle Button - Professional Brown Gradient */
        .menu-toggle {
            position: fixed;
            top: 30px;
            left: 360px;
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 0.8rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .menu-toggle.collapsed {
            left: 20px;
        }

        .menu-toggle:hover {
            background: linear-gradient(135deg, #a0522d, #8b4513);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
        }

        .menu-toggle-label {
            position: fixed;
            top: 85px;
            left: 382px;
            background: rgba(139, 69, 19, 0.9);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 8px rgba(139, 69, 19, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
            min-width: 45px;
            transform: translateX(-50%);
            pointer-events: none;
        }

        .menu-toggle-label.collapsed {
            left: 42px;
        }

        /* Slide-out Menu */
        .slide-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 350px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: blur(20px);
            box-shadow: 4px 0 24px rgba(212, 175, 55, 0.15);
            border-right: 2px solid rgba(212, 175, 55, 0.15);
            transition: left 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            padding-top: 20px;
        }

        .slide-menu::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(255, 215, 0, 0.02) 0%, rgba(212, 175, 55, 0.03) 100%);
            z-index: 0;
            pointer-events: none;
        }

        .slide-menu.collapsed {
            left: -350px;
        }

        .menu-header {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            padding: 2rem 1.5rem 1.2rem 1.5rem;
            text-align: center;
            position: relative;
            z-index: 2;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 70px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.2);
        }

        .menu-bookmark-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
        }

        .menu-subtitle {
            font-size: 0.85rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .menu-content {
            padding: 1.5rem 0;
            position: relative;
            z-index: 2;
        }

        .menu-item {
            display: block;
            padding: 0.8rem 1.5rem;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border-left: 3px solid transparent;
            margin: 0.3rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .menu-item:hover,
        .menu-item.active {
            background: rgba(212, 175, 55, 0.1);
            border-left-color: #d4af37;
            transform: translateX(5px);
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            padding: 3rem 0;
            margin-bottom: 2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #8b4513, #d4af37, #8b4513);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.02em;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: #8b4513;
            font-weight: 600;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .hero-description {
            font-size: 1.1rem;
            color: #666;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Content sections */
        .content-section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 2rem;
            color: #8b4513;
            margin-bottom: 1.5rem;
            font-weight: 800;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        /* Instructions styling */
        .instructions {
            background: linear-gradient(135deg, #ffd700, #d4af37);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border-left: 5px solid #8b4513;
        }

        .instructions h3 {
            color: #8b4513;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .instructions ul {
            margin-left: 1.5rem;
        }

        .instructions li {
            color: #5d3a0a;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        /* Question Selection */
        .question-selection {
            background: rgba(139, 69, 19, 0.05);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .question-selection h3 {
            color: #8b4513;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .question-selection select {
            padding: 0.5rem;
            border-radius: 5px;
            border: 1px solid #d4af37;
            font-size: 0.9rem;
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
            display: block;
            background: white;
        }

        /* Current Question Display */
        .current-question {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(139, 69, 19, 0.05));
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            border-left: 5px solid #d4af37;
        }

        .current-question h4 {
            color: #8b4513;
            font-size: 1.4rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .question-text {
            font-size: 1.2rem;
            color: #333;
            text-align: center;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.7);
            padding: 1rem;
            border-radius: 10px;
        }

        /* Recording Controls */
        .recording-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .control-btn {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            min-width: 120px;
            justify-content: center;
        }

        .control-btn:hover {
            background: linear-gradient(135deg, #a0522d, #8b4513);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.3);
        }

        .control-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .control-btn.recording {
            background: linear-gradient(135deg, #dc3545, #c82333);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }

        /* Timer Display */
        .timer-display {
            text-align: center;
            margin: 1.5rem 0;
        }

        .timer {
            font-size: 2rem;
            font-weight: bold;
            color: #8b4513;
            background: rgba(255, 255, 255, 0.8);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            display: inline-block;
            min-width: 100px;
        }

        /* Audio Visualization */
        .audio-visualization {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 1rem;
            margin: 1.5rem 0;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .audio-bars {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
            height: 50px;
        }

        .audio-bar {
            width: 3px;
            background: linear-gradient(to top, #8b4513, #d4af37);
            border-radius: 2px;
            animation: audioWave 1s ease-in-out infinite alternate;
        }

        .audio-bar:nth-child(2) { animation-delay: 0.1s; }
        .audio-bar:nth-child(3) { animation-delay: 0.2s; }
        .audio-bar:nth-child(4) { animation-delay: 0.3s; }
        .audio-bar:nth-child(5) { animation-delay: 0.4s; }

        @keyframes audioWave {
            from { height: 5px; opacity: 0.5; }
            to { height: 50px; opacity: 1; }
        }

        /* Analysis Section */
        .analysis-section {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(139, 69, 19, 0.05));
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .analysis-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid #d4af37;
        }

        .analysis-card h4 {
            color: #8b4513;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .analysis-card p {
            color: #666;
            line-height: 1.6;
        }

        #feedbackText {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.95rem;
        }

        .analysis-processing {
            background: linear-gradient(90deg, #8b4513, #d4af37, #8b4513);
            background-size: 200% 200%;
            animation: analysisShimmer 2s linear infinite;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        @keyframes analysisShimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* Navigation Buttons */
        .navigation-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .next-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .next-btn:nth-child(2) {
            background: linear-gradient(135deg, #3498db, #2980b9);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .next-btn:nth-child(2):hover {
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        /* Band Score Guidance */
        .band-guidance {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            border: 2px solid #d4af37;
        }

        .band-criteria {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .criteria-card {
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.05), rgba(212, 175, 55, 0.05));
            padding: 1.5rem;
            border-radius: 10px;
            border-top: 3px solid #8b4513;
        }

        .criteria-card h5 {
            color: #8b4513;
            margin-bottom: 0.8rem;
            font-size: 1rem;
        }

        .criteria-card p {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin-left: 0 !important;
            }

            .menu-toggle {
                left: 20px;
            }

            .menu-toggle-label {
                left: 42px;
            }

            .slide-menu {
                width: 100%;
                left: -100%;
            }

            .slide-menu.collapsed {
                left: -100%;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .hero-subtitle {
                font-size: 1.1rem;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .band-criteria {
                grid-template-columns: 1fr;
            }

            .recording-controls {
                flex-direction: column;
                align-items: center;
            }

            .control-btn {
                width: 80%;
                max-width: 250px;
            }
        }

        /* Hidden elements */
        .hidden {
            display: none;
        }

        /* Processing animation */
        .processing {
            animation: processing 2s linear infinite;
        }

        @keyframes processing {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .processing {
            background: linear-gradient(90deg, #8b4513, #d4af37, #8b4513);
            background-size: 200% 200%;
        }
    </style>
</head>
<body>
    <div class="header-spacer"></div>

    <!-- Guruvammal Logo Container (Back Button) -->
    <div class="gk-logo-container" onclick="handleBackButton()">
        <div class="master-guruvammal-logo">
            Ga<span class="musical-corner">P</span>
        </div>
        <div class="back-label">Back</div>
    </div>

    <!-- Slide-out Menu Toggle Button -->
    <button class="menu-toggle" onclick="toggleMenu()" id="menuToggle">
        ‚Ä∫
    </button>
    <div class="menu-toggle-label" id="menuToggleLabel">Collapse</div>

    <!-- Slide-out Menu -->
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <div class="menu-bookmark-title">IELTS Academic Speaking Part 1</div>
            <div class="menu-subtitle">Research Methods</div>
        </div>
        <div class="menu-content">
            <div class="menu-item" onclick="scrollToSection('instructions')">üìã Instructions</div>
            <div class="menu-item active" onclick="scrollToSection('recording')">üéôÔ∏è Recording Studio</div>
            <div class="menu-item" onclick="scrollToSection('analysis')">üìä Analysis Results</div>
            <div class="menu-item" onclick="scrollToSection('guidance')">üéØ Band Score Guidance</div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container" id="container">
        <main class="main-content">
            <!-- Hero Section -->
            <section class="hero-section">
                <h1 class="hero-title">IELTS Academic Speaking Part 1</h1>
                <div class="hero-subtitle">Research Methods Practice</div>
                <p class="hero-description">
                    Master research methodology questions with our interactive practice studio. Practice answering common Part 1 questions about your research approaches, data collection techniques, and analytical methods. Record your responses and get personalized feedback to improve your academic speaking skills and achieve your target band score.
                </p>
            </section>

            <!-- Instructions Section -->
            <section class="content-section" id="instructions">
                <h2 class="section-title">
                    üìã Instructions
                </h2>
                <div class="instructions">
                    <h3>How to Use This Research Methods Practice Studio</h3>
                    <ul>
                        <li><strong>Select a Question:</strong> Choose from 6 research methodology questions below</li>
                        <li><strong>Prepare:</strong> Think about your research experience for 10-15 seconds</li>
                        <li><strong>Record:</strong> Click "Start Recording" and speak for 30-60 seconds</li>
                        <li><strong>Review:</strong> Listen to your recording and analyze your performance</li>
                        <li><strong>Practice:</strong> Repeat with different questions to improve your fluency</li>
                    </ul>
                </div>
                
                <div class="question-selection">
                    <h3>üî¨ Select Your Research Question</h3>
                    <select id="questionSelect" onchange="updateCurrentQuestion()">
                        <option value="1">Q1: What research methods do you typically use in your studies?</option>
                        <option value="2">Q2: How do you collect data for your research projects?</option>
                        <option value="3">Q3: What analytical tools or software do you use for research?</option>
                        <option value="4">Q4: How do you ensure the reliability of your research findings?</option>
                        <option value="5">Q5: What challenges have you faced in conducting research?</option>
                        <option value="6">Q6: How do you stay updated with current research in your field?</option>
                    </select>
                </div>
            </section>

            <!-- Recording Section -->
            <section class="content-section" id="recording">
                <h2 class="section-title">
                    üéôÔ∏è Recording Studio
                </h2>
                
                <!-- Current Question Display -->
                <div class="current-question">
                    <h4>Current Question:</h4>
                    <div class="question-text" id="currentQuestionText">
                        What research methods do you typically use in your studies?
                    </div>
                </div>

                <!-- Timer Display -->
                <div class="timer-display">
                    <div class="timer" id="timer">00:00</div>
                </div>

                <!-- Recording Controls -->
                <div class="recording-controls">
                    <button class="control-btn" id="recordBtn" onclick="startRecording()">
                        üéôÔ∏è Start Recording
                    </button>
                    <button class="control-btn" id="stopBtn" onclick="stopRecording()" disabled>
                        ‚èπÔ∏è Stop Recording
                    </button>
                    <button class="control-btn" id="playBtn" onclick="playRecording()" disabled>
                        ‚ñ∂Ô∏è Play Recording
                    </button>
                    <button class="control-btn" id="processBtn" onclick="processAudio()" disabled>
                        üìä Analyze Speech
                    </button>
                </div>

                <!-- Audio Visualization -->
                <div class="audio-visualization" id="audioVisualization">
                    <div class="audio-bars hidden" id="audioBars">
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                    </div>
                    <p id="visualizationText">Click "Start Recording" to begin your research methods speaking practice</p>
                </div>
            </section>

            <!-- Analysis Section -->
            <section class="content-section hidden" id="analysis">
                <h2 class="section-title">
                    üìä Analysis Results
                </h2>
                
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>üìù Example Response</h4>
                        <p id="transcriptionText" style="font-style: italic; color: #555;">A model research methodology response will appear here to guide your speaking practice. This shows the level of detail and vocabulary expected for research-focused topics.</p>
                    </div>
                    
                    <div class="analysis-card">
                        <h4>üéØ Your Personal Analysis & Feedback</h4>
                        <p id="feedbackText" style="white-space: pre-line;">Based on your actual recording, personalized feedback on your pronunciation, fluency, grammar, and research vocabulary usage will appear here. This analysis is tailored specifically to your research methodology response.</p>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="navigation-buttons">
                    <button class="control-btn next-btn" onclick="goToNextQuestion()">
                        ‚û°Ô∏è Next Question
                    </button>
                    <button class="control-btn next-btn" onclick="refreshCurrentQuestion()">
                        üîÑ Retry
                    </button>
                </div>
            </section>

            <!-- Band Score Guidance -->
            <section class="content-section" id="guidance">
                <h2 class="section-title">
                    üéØ Band Score Guidance
                </h2>
                
                <div class="band-guidance">
                    <h3 style="color: #8b4513; text-align: center; margin-bottom: 1.5rem;">Research Methods Assessment Criteria</h3>
                    
                    <div class="band-criteria">
                        <div class="criteria-card">
                            <h5>üó£Ô∏è Fluency & Coherence</h5>
                            <p>Speak confidently about your research methods using appropriate academic discourse markers. Maintain logical flow when explaining methodological approaches and analytical processes.</p>
                        </div>
                        
                        <div class="criteria-card">
                            <h5>üìö Lexical Resource</h5>
                            <p>Demonstrate mastery of research terminology including methodological concepts, data collection techniques, analytical tools, and academic validation processes specific to your field.</p>
                        </div>
                        
                        <div class="criteria-card">
                            <h5>‚öôÔ∏è Grammatical Range</h5>
                            <p>Use complex structures to describe research processes and methodologies. Employ appropriate tenses when discussing past research, current methods, and future applications.</p>
                        </div>
                        
                        <div class="criteria-card">
                            <h5>üéØ Pronunciation</h5>
                            <p>Articulate research terminology clearly with appropriate stress on methodological concepts. Maintain natural rhythm when discussing complex research procedures and analytical approaches.</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- JavaScript -->
    <script>
        // Research Methods Questions
        const questions = {
            1: "What research methods do you typically use in your studies?",
            2: "How do you collect data for your research projects?", 
            3: "What analytical tools or software do you use for research?",
            4: "How do you ensure the reliability of your research findings?",
            5: "What challenges have you faced in conducting research?",
            6: "How do you stay updated with current research in your field?"
        };

        // Audio recording variables
        let mediaRecorder;
        let audioChunks = [];
        let recordingTimeout;
        let startTime;
        let timerInterval;
        let audioContext;
        let analyser;
        let microphone;
        let isRecording = false;
        let originalAudioBlob = null;
        let recordingSeconds = 0;
        let recordingTimer;
        let animationFrameId;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ IELTS Academic Speaking Part 1: Research Methods loaded');
            updateCurrentQuestion();
            
            // Set initial UI state
            updateUI('idle');
            
            // Check for audio support
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                updateRecordingStatus('Audio recording not supported in this browser');
                document.getElementById('recordBtn').disabled = true;
                console.warn('‚ö†Ô∏è Audio recording not supported');
            }
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (isRecording) {
                stopRecording();
            }
        });

        // Update current question display
        function updateCurrentQuestion() {
            const select = document.getElementById('questionSelect');
            const questionText = document.getElementById('currentQuestionText');
            const selectedValue = select.value;
            questionText.textContent = questions[selectedValue];
            
            // Reset the recording state when question changes
            resetRecordingState();
        }

        // Reset recording state
        function resetRecordingState() {
            // Stop any ongoing recording
            if (isRecording) {
                stopRecording();
            }
            
            // Reset variables
            isRecording = false;
            originalAudioBlob = null;
            recordingSeconds = 0;
            
            // Reset timer
            const timer = document.getElementById('timer');
            timer.textContent = '00:00';
            
            // Hide analysis section
            document.getElementById('analysis').classList.add('hidden');
            
            // Reset visualization
            const audioBars = document.getElementById('audioBars');
            audioBars.classList.add('hidden');
            
            // Update UI to idle state
            updateUI('idle');
        }

        // Start recording
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        sampleRate: 44100
                    } 
                });
                
                audioChunks = [];
                mediaRecorder = new MediaRecorder(stream, {
                    mimeType: 'audio/webm;codecs=opus'
                });
                
                mediaRecorder.ondataavailable = event => {
                    audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    originalAudioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    const audioUrl = URL.createObjectURL(originalAudioBlob);
                    
                    // Store audio URL for playback
                    window.currentAudioUrl = audioUrl;
                    
                    // Update UI to recorded state
                    updateUI('recorded');
                    updateRecordingStatus('Recording complete! You can play it back or analyze your speech');
                };
                
                // Setup audio visualization
                setupAudioVisualization(stream);
                
                mediaRecorder.start();
                isRecording = true;
                startTime = Date.now();
                recordingSeconds = 0;
                
                // Update UI to recording state
                updateUI('recording');
                
                // Start timer
                startTimer();
                
                // Show visualization
                const audioBars = document.getElementById('audioBars');
                const visualizationText = document.getElementById('visualizationText');
                audioBars.classList.remove('hidden');
                visualizationText.textContent = 'Recording... Speak clearly about your research methodology';
                
                // Auto-stop after 2 minutes
                recordingTimeout = setTimeout(() => {
                    stopRecording();
                }, 120000);
                
                console.log('üéôÔ∏è Recording started for Research Methods question');
                
            } catch (error) {
                console.error('‚ùå Error starting recording:', error);
                alert('Unable to access microphone. Please check your permissions.');
            }
        }

        // Stop recording
        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
                isRecording = false;
                clearInterval(recordingTimer);
                cancelAnimationFrame(animationFrameId);
                
                // Stop timer
                stopTimer();
                
                // Clear timeout
                if (recordingTimeout) {
                    clearTimeout(recordingTimeout);
                }
                
                // Update visualization
                const audioBars = document.getElementById('audioBars');
                const visualizationText = document.getElementById('visualizationText');
                audioBars.classList.add('hidden');
                visualizationText.textContent = 'Recording completed. Click "Play Recording" to listen or "Analyze Speech" for feedback.';
                
                // Reset visualizer bars
                const bars = document.querySelectorAll('.audio-bar');
                bars.forEach(bar => bar.style.height = '5px');
                
                console.log('‚èπÔ∏è Recording stopped');
            }
        }

        // Play recording
        function playRecording() {
            if (window.currentAudioUrl) {
                const audio = new Audio(window.currentAudioUrl);
                audio.play();
                console.log('‚ñ∂Ô∏è Playing recording');
            }
        }

        // Process audio and show analysis
        async function processAudio() {
            if (!originalAudioBlob) return;
            
            const analysisSection = document.getElementById('analysis');
            const transcriptionText = document.getElementById('transcriptionText');
            const feedbackText = document.getElementById('feedbackText');
            
            // Update UI to processing state
            updateUI('processing');
            updateRecordingStatus('Converting speech to text and analyzing...');
            
            try {
                // Show analysis section with processing indicator
                analysisSection.classList.remove('hidden');
                feedbackText.innerHTML = '<div class="analysis-processing">üîÑ Analyzing your recorded voice...</div>';
                transcriptionText.textContent = 'Loading example response...';
                
                // Step 1: Simulate speech-to-text conversion
                updateRecordingStatus('Converting your speech to text...');
                feedbackText.innerHTML = '<div class="analysis-processing">üéôÔ∏è Converting speech to text...</div>';
                const transcript = await simulateSpeechToText(originalAudioBlob);
                
                // Step 2: Analyze the transcribed text
                updateRecordingStatus('Analyzing your research methodology response...');
                feedbackText.innerHTML = '<div class="analysis-processing">üß† Analyzing your research language skills...</div>';
                const analysis = await analyzeAcademicResponse(transcript);
                
                // Step 3: Display results
                const currentQuestion = document.getElementById('questionSelect').value;
                const exampleResponse = getResearchMethodsExampleResponse(currentQuestion);
                
                // Show example response (unchanged)
                transcriptionText.textContent = exampleResponse;
                
                // Show personalized feedback based on actual recording
                feedbackText.textContent = analysis.personalizedFeedback;
                
                // Scroll to show completed analysis
                setTimeout(() => {
                    analysisSection.scrollIntoView({ behavior: 'smooth' });
                }, 300);
                
                // Update UI back to idle state
                updateUI('idle');
                updateRecordingStatus('Analysis complete! Review your personalized feedback below.');
                
                console.log('üìä Audio analysis completed with personalized feedback');
                
            } catch (error) {
                console.error('Processing Error:', error);
                updateRecordingStatus('Error during analysis. Please try again.');
                
                // Reset analysis section on error
                feedbackText.textContent = 'Analysis failed. Please try recording again.';
                transcriptionText.textContent = 'Example response will appear after successful analysis.';
                
                updateUI('idle');
            }
        }

        // Simulate Speech-to-Text conversion
        async function simulateSpeechToText(audioBlob) {
            // Simulate processing time
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Analyze audio properties to simulate more realistic transcription
            const audioUrl = URL.createObjectURL(audioBlob);
            const audio = new Audio(audioUrl);
            
            // Get audio duration and simulate content based on recording length
            return new Promise((resolve) => {
                audio.addEventListener('loadedmetadata', () => {
                    const duration = audio.duration;
                    const currentQuestion = document.getElementById('questionSelect').value;
                    
                    // Generate simulated transcript based on duration and question
                    let transcript = generateSimulatedTranscript(currentQuestion, duration);
                    
                    // Add duration info for analysis
                    transcript.recordingDuration = duration;
                    
                    resolve(transcript);
                });
                audio.load();
            });
        }

        // Generate simulated transcript based on recording characteristics  
        function generateSimulatedTranscript(questionNumber, duration) {
            const baseResponses = {
                1: ["In my research, I primarily use", "My methodology typically involves", "I apply both qualitative and quantitative", "My research approach includes"],
                2: ["For data collection, I use", "I gather information through", "My data collection methods include", "I collect research data by"],
                3: ["I use various analytical tools including", "My research software includes", "For analysis, I work with", "The tools I use for research are"],
                4: ["To ensure reliability, I", "I validate my findings through", "Research reliability is maintained by", "I ensure accuracy through"],
                5: ["The main challenges I've encountered", "Research obstacles I've faced include", "Difficulties in my research involve", "I've had to overcome challenges such as"],
                6: ["I stay current through", "I keep updated by", "To follow latest research, I", "I maintain awareness of developments through"]
            };
            
            // Simulate variations based on recording duration
            let response = baseResponses[questionNumber] ? 
                baseResponses[questionNumber][Math.floor(Math.random() * baseResponses[questionNumber].length)] : 
                "I would like to discuss my research methods";
            
            if (duration < 10) {
                response += " [Short response - aim for 30-60 seconds]";
            } else if (duration < 30) {
                response += " [Good length response]";
            } else {
                response += " [Detailed response - good development of ideas]";
            }
            
            return response;
        }

        // Analyze academic response and provide personalized feedback
        async function analyzeAcademicResponse(transcript) {
            // Simulate analysis processing time
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            const currentQuestion = document.getElementById('questionSelect').value;
            
            // Analyze transcript characteristics (handle both string and object with duration)
            const transcriptText = typeof transcript === 'string' ? transcript : transcript.toString();
            const duration = transcript.recordingDuration || 0;
            
            const wordCount = transcriptText.split(' ').length;
            const hasResearchTerms = /research|methodology|data|analysis|quantitative|qualitative|survey|experiment|hypothesis|variables|statistical|findings/i.test(transcriptText);
            const responseLength = transcriptText.length;
            
            // Generate personalized feedback based on analysis
            let feedback = generatePersonalizedFeedback(currentQuestion, {
                wordCount: wordCount,
                hasResearchTerms: hasResearchTerms,
                responseLength: responseLength,
                transcript: transcriptText,
                duration: duration
            });
            
            return {
                personalizedFeedback: feedback
            };
        }

        // Generate personalized feedback based on user's actual response
        function generatePersonalizedFeedback(questionNumber, analysis) {
            let feedback = "Based on your recorded response:\n\n";
            
            // Analyze actual recording duration
            if (analysis.duration && analysis.duration > 0) {
                if (analysis.duration < 15) {
                    feedback += "‚è±Ô∏è **Recording Duration**: " + Math.round(analysis.duration) + " seconds - This is quite short for IELTS Part 1. Aim for 30-60 seconds to fully develop your research methodology explanations.\n\n";
                } else if (analysis.duration >= 30 && analysis.duration <= 60) {
                    feedback += "‚úÖ **Recording Duration**: " + Math.round(analysis.duration) + " seconds - Perfect timing for IELTS Part 1! This allows for complete explanation of research methods.\n\n";
                } else if (analysis.duration > 60) {
                    feedback += "‚è∞ **Recording Duration**: " + Math.round(analysis.duration) + " seconds - Good detail, but try to be more concise for Part 1 responses.\n\n";
                } else {
                    feedback += "üëç **Recording Duration**: " + Math.round(analysis.duration) + " seconds - Good length for Part 1.\n\n";
                }
            }
            
            // Analyze response content depth
            if (analysis.wordCount < 10) {
                feedback += "üîç **Content Depth**: Your response appears brief. Include more specific details about your research methods, tools, and processes for stronger academic responses.\n\n";
            } else if (analysis.wordCount > 50) {
                feedback += "‚úÖ **Content Depth**: Good detailed response! You provided substantial information about your research methodology.\n\n";
            } else {
                feedback += "üëç **Content Depth**: Appropriate detail level. Consider adding one more specific example or methodological approach.\n\n";
            }
            
            // Analyze research vocabulary usage
            if (analysis.hasResearchTerms) {
                feedback += "‚úÖ **Research Vocabulary**: Excellent use of methodological terminology! This demonstrates strong academic research language skills.\n\n";
            } else {
                feedback += "üí° **Research Vocabulary**: Try incorporating more research-specific terms like 'methodology', 'data analysis', 'variables', 'sampling', or field-specific techniques.\n\n";
            }
            
            // Question-specific feedback
            const questionSpecificTips = {
                1: "For research methods questions, mention specific approaches (qualitative/quantitative), techniques (surveys, interviews, experiments), and explain why you choose certain methods.",
                2: "When discussing data collection, describe specific techniques, tools, sample sizes, and data sources. Mention ethical considerations if applicable.",
                3: "Research tools responses should include specific software names, statistical packages, databases, or analytical frameworks you actually use in your work.",
                4: "Reliability discussions should cover validation techniques, peer review, replication, triangulation, or quality assurance measures in your research.",
                5: "Research challenges should include specific methodological obstacles, resource limitations, ethical issues, or technical difficulties you've encountered.", 
                6: "Staying updated responses should mention specific journals, conferences, databases, professional networks, or research communities in your field."
            };
            
            feedback += "üéØ **Content Suggestion**: " + (questionSpecificTips[questionNumber] || "Provide more specific details about your research methodology experience.");
            feedback += "\n\nüìà **Next Steps**: Practice speaking with confidence about your research processes, use varied sentence structures, and include concrete methodological examples.";
            feedback += "\n\nüí° **Note**: This feedback is based on the analysis of your actual recorded response, including timing, content depth, and research methodology language usage.";
            
            return feedback;
        }

        // Get research methods example responses (kept intact as requested)
        function getResearchMethodsExampleResponse(questionNumber) {
            const exampleResponses = {
                1: "In my research, I primarily use mixed-methods approaches, combining both quantitative and qualitative techniques. For quantitative analysis, I employ statistical surveys and experimental designs to gather measurable data. For qualitative insights, I conduct structured interviews and focus groups. I also use systematic literature reviews to establish theoretical frameworks and comparative case studies to examine different scenarios within my field of environmental science.",
                2: "My data collection methods vary depending on the research question, but I typically use online surveys distributed through academic networks to reach large sample sizes. For in-depth insights, I conduct semi-structured interviews with experts in my field. I also gather secondary data from government databases, published research papers, and institutional reports. When conducting fieldwork, I use standardized measurement tools and follow strict protocols to ensure data validity and consistency.",
                3: "I work with several analytical tools depending on the research phase. For statistical analysis, I use SPSS and R programming for complex data modeling and hypothesis testing. For qualitative data analysis, I employ NVivo software to code and categorize interview transcripts and identify patterns. I also use reference management software like Zotero for literature organization and citation management, and various data visualization tools like Tableau for presenting research findings clearly.",
                4: "To ensure reliability, I implement multiple validation strategies throughout my research process. I use triangulation by collecting data through different methods and sources to cross-verify findings. I conduct pilot studies to test my instruments before full-scale data collection. I also establish inter-rater reliability when multiple researchers are involved in coding or assessment. Additionally, I maintain detailed research logs, follow standardized protocols, and seek peer review feedback to identify potential biases or methodological weaknesses.",
                5: "The primary challenge I've encountered is accessing sufficient sample sizes for my specialized research area. Environmental policy research often involves hard-to-reach populations, so I've had to develop innovative recruitment strategies using professional networks and snowball sampling. Another significant challenge has been managing the time-intensive nature of longitudinal studies while balancing academic deadlines. I've also faced difficulties with data quality when working with historical datasets that have inconsistent recording methods.",
                6: "I stay updated through multiple channels to ensure I'm aware of the latest developments in my field. I subscribe to key academic journals and set up Google Scholar alerts for specific keywords related to my research area. I regularly attend academic conferences, both in-person and virtual, to learn about cutting-edge research and network with colleagues. I'm also active in professional associations and online research communities where scholars share recent findings and discuss methodological innovations."
            };
            
            return exampleResponses[questionNumber] || "Great research methodology response! Focus on using specific methodological vocabulary and providing concrete examples from your research experience.";
        }

        // Setup audio visualization
        function setupAudioVisualization(stream) {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                microphone = audioContext.createMediaStreamSource(stream);
                
                analyser.fftSize = 256;
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                
                microphone.connect(analyser);
                
                function updateVisualization() {
                    if (mediaRecorder && mediaRecorder.state === 'recording') {
                        analyser.getByteFrequencyData(dataArray);
                        
                        // Update audio bars based on frequency data
                        const bars = document.querySelectorAll('.audio-bar');
                        bars.forEach((bar, index) => {
                            const value = dataArray[index * 10] || 0;
                            const height = Math.max(5, (value / 255) * 50);
                            bar.style.height = height + 'px';
                        });
                        
                        requestAnimationFrame(updateVisualization);
                    }
                }
                
                updateVisualization();
            } catch (error) {
                console.warn('‚ö†Ô∏è Audio visualization not supported:', error);
            }
        }

        // Timer functions
        function startTimer() {
            timerInterval = setInterval(() => {
                recordingSeconds++;
                updateTimerDisplay();
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(recordingSeconds / 60);
            const seconds = recordingSeconds % 60;
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timer').textContent = timeString;
        }

        // Update UI based on current state
        function updateUI(state) {
            const recordBtn = document.getElementById('recordBtn');
            const stopBtn = document.getElementById('stopBtn');
            const playBtn = document.getElementById('playBtn');
            const processBtn = document.getElementById('processBtn');
            
            // Reset all buttons
            recordBtn.disabled = false;
            stopBtn.disabled = true;
            playBtn.disabled = true;
            processBtn.disabled = true;
            
            // Remove all state classes
            recordBtn.classList.remove('recording', 'processing');
            processBtn.classList.remove('processing');
            
            switch(state) {
                case 'recording':
                    recordBtn.disabled = true;
                    recordBtn.classList.add('recording');
                    stopBtn.disabled = false;
                    updateRecordingStatus('Recording... Speak clearly about your research methodology');
                    break;
                case 'recorded':
                    playBtn.disabled = false;
                    processBtn.disabled = false;
                    updateRecordingStatus('Recording complete! You can play it back or analyze your speech');
                    break;
                case 'processing':
                    recordBtn.disabled = true;
                    playBtn.disabled = true;
                    processBtn.disabled = true;
                    processBtn.classList.add('processing');
                    processBtn.textContent = '‚è≥ Processing...';
                    updateRecordingStatus('System is analyzing and improving your research methodology response...');
                    break;
                case 'idle':
                default:
                    processBtn.textContent = 'üìä Analyze Speech';
                    updateRecordingStatus('Ready to record your response to the research methodology question');
                    break;
            }
        }

        // Update recording status display
        function updateRecordingStatus(message) {
            const visualizationText = document.getElementById('visualizationText');
            if (visualizationText) {
                visualizationText.textContent = message;
                
                // Update visualization styling based on content
                if (message.includes('Recording')) {
                    visualizationText.style.color = '#dc3545';
                    visualizationText.style.fontWeight = 'bold';
                } else if (message.includes('complete') || message.includes('finished') || message.includes('ready')) {
                    visualizationText.style.color = '#28a745';
                    visualizationText.style.fontWeight = 'bold';
                } else if (message.includes('Processing') || message.includes('analyzing')) {
                    visualizationText.style.color = '#ffc107';
                    visualizationText.style.fontWeight = 'bold';
                } else {
                    visualizationText.style.color = '#333';
                    visualizationText.style.fontWeight = 'normal';
                }
            }
        }

        // Navigation functions
        function handleBackButton() {
            console.log('üîÑ Back button clicked from IELTS Academic Speaking Part 1 - Going to Academic Introduction');
            window.location.href = 'IELTS_Academic_Speaking_Introduction.html';
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
            
            // Update active menu item
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Menu toggle functionality
        function toggleMenu() {
            const menu = document.getElementById('slideMenu');
            const toggleBtn = document.getElementById('menuToggle');
            const toggleLabel = document.getElementById('menuToggleLabel');
            const container = document.getElementById('container');
            const isCollapsed = menu.classList.contains('collapsed');
            
            if (isCollapsed) {
                menu.classList.remove('collapsed');
                toggleBtn.classList.remove('collapsed');
                toggleLabel.classList.remove('collapsed');
                container.classList.remove('menu-collapsed');
                toggleBtn.innerHTML = '‚Ä∫';
                toggleLabel.textContent = 'Collapse';
            } else {
                menu.classList.add('collapsed');
                toggleBtn.classList.add('collapsed');
                toggleLabel.classList.add('collapsed');
                container.classList.add('menu-collapsed');
                toggleBtn.innerHTML = '‚Äπ';
                toggleLabel.textContent = 'Expand';
            }
        }

        // Navigation Functions for Analysis Results
        function goToNextQuestion() {
            // Get current question number
            const currentQuestion = parseInt(document.getElementById('questionSelect').value);
            
            // Calculate next question (cycle back to 1 if we're at question 6)
            const nextQuestion = currentQuestion >= 6 ? 1 : currentQuestion + 1;
            
            // Update dropdown to next question
            document.getElementById('questionSelect').value = nextQuestion;
            updateCurrentQuestion();
            
            // Scroll to top of recording section
            document.getElementById('recording').scrollIntoView({ behavior: 'smooth' });
        }

        function refreshCurrentQuestion() {
            // Reset the current question/session
            resetRecordingState();
            
            // Scroll to top of recording section
            document.getElementById('recording').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html> 
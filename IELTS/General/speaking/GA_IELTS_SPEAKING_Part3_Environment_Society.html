<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS General Speaking Part 3: Environment & Society | Gammapace</title>
    
    <!-- Standardized CSS with Part 3 Adaptations -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(139, 69, 19, 0.2) 50%, rgba(255, 215, 0, 0.1) 100%);
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(139, 69, 19, 0.05) 0%, transparent 50%);
            z-index: -1;
            pointer-events: none;
        }

        /* Header spacing */
        .header-spacer {
            height: 20px;
            width: 100%;
        }

        /* Master Guruvammal Logo as Back Button - Right Side */
        .gk-logo-container {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1002;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }

        /* Master Guruvammal Logo */
        .master-guruvammal-logo {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            box-sizing: border-box;
            font-family: 'Century Gothic', sans-serif;
            font-size: 26px;
            font-weight: 900;
            letter-spacing: -1px;
            line-height: 1;
            color: #5d3a0a;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(139, 69, 19, 0.25) 50%, rgba(205, 133, 63, 0.2) 100%);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.3), 0 0 40px rgba(212, 175, 55, 0.2);
            z-index: 10000;
            transition: all 0.3s ease;
        }

        .master-guruvammal-logo .musical-corner {
            position: absolute;
            top: 3px;
            right: 4px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: transparent;
            border: 1px solid #5d3a0a;
            color: #5d3a0a;
            font-family: 'Century Gothic', sans-serif;
            font-size: 7px;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            box-shadow: none;
        }

        .master-guruvammal-logo:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(139, 69, 19, 0.4), 0 0 50px rgba(212, 175, 55, 0.3);
        }

        .foundation-text {
            font-size: 1rem;
            font-weight: bold;
            color: #8b4513;
            font-family: 'Century Gothic', sans-serif;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }

        .back-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #8b4513;
            font-family: 'Century Gothic', sans-serif;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
            text-align: center;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover .back-label {
            color: #5d3a0a;
            transform: translateY(-1px);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            margin-left: 360px;
            transition: margin-left 0.3s ease;
        }

        .container.menu-collapsed {
            margin-left: 20px;
        }

        /* Main Content */
        .main-content {
            margin-top: 0;
            padding: 1.5rem 2rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Menu Toggle Button - Professional Brown Gradient */
        .menu-toggle {
            position: fixed;
            top: 30px;
            left: 360px;
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 0.8rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .menu-toggle.collapsed {
            left: 20px;
        }

        .menu-toggle:hover {
            background: linear-gradient(135deg, #a0522d, #8b4513);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
        }

        .menu-toggle-label {
            position: fixed;
            top: 85px;
            left: 382px;
            background: rgba(139, 69, 19, 0.9);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 8px rgba(139, 69, 19, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
            min-width: 45px;
            transform: translateX(-50%);
            pointer-events: none;
        }

        .menu-toggle-label.collapsed {
            left: 42px;
        }

        /* Slide-out Menu */
        .slide-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 350px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: blur(20px);
            box-shadow: 4px 0 24px rgba(212, 175, 55, 0.15);
            border-right: 2px solid rgba(212, 175, 55, 0.15);
            transition: left 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            padding-top: 20px;
        }

        .slide-menu::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(255, 215, 0, 0.02) 0%, rgba(212, 175, 55, 0.03) 100%);
            z-index: 0;
            pointer-events: none;
        }

        .slide-menu.collapsed {
            left: -350px;
        }

        .menu-header {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            padding: 2rem 1.5rem 1.2rem 1.5rem;
            text-align: center;
            position: relative;
            z-index: 2;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 70px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.2);
        }

        .menu-bookmark-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
        }

        .menu-subtitle {
            font-size: 0.85rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .menu-content {
            padding: 1.5rem 0;
            position: relative;
            z-index: 2;
        }

        .menu-item {
            display: block;
            padding: 0.8rem 1.5rem;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: rgba(212, 175, 55, 0.1);
            border-left-color: #d4af37;
            transform: translateX(5px);
        }

        .menu-item.active {
            background: rgba(212, 175, 55, 0.15);
            border-left-color: #8b4513;
            font-weight: 600;
        }

        .item-title {
            font-size: 0.95rem;
            font-weight: 500;
        }

        /* Content sections */
        .content-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 2.5rem;
            color: #8b4513;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 700;
        }

        .hero-title {
            font-size: 2.8rem;
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 1rem;
            text-align: center;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: #3c2d1f;
            margin-bottom: 2rem;
            text-align: center;
            padding: 1rem 2rem;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
        }

        /* Part 3 Specific: Discussion Section */
        .discussion-section {
            background: rgba(212, 175, 55, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .discussion-question {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(139, 69, 19, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .discussion-question:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.15);
        }

        .discussion-question.active {
            border-color: #8b4513;
            background: rgba(212, 175, 55, 0.1);
        }

        .discussion-question h4 {
            color: #8b4513;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .question-tips {
            background: rgba(139, 69, 19, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #666;
            display: none;
        }

        .discussion-question.active .question-tips {
            display: block;
        }

        /* Question Selection */
        .question-selection {
            text-align: center;
            margin: 2rem 0;
        }

        #questionSelect {
            padding: 0.5rem;
            border-radius: 5px;
            border: 1px solid #d4af37;
            font-size: 0.9rem;
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
            display: block;
        }

        /* Timer Display */
        .timer-display {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            margin: 1rem 0;
        }

        .timer {
            font-size: 2rem;
            font-weight: bold;
            color: #8b4513;
            font-family: 'Courier New', monospace;
        }

        .timer-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }

        /* Control Buttons */
        .control-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin: 2rem 0;
        }

        .control-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 140px;
        }

        .record-btn {
            background: linear-gradient(135deg, #f44336, #da190b);
            color: white;
        }

        .record-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }

        .stop-btn {
            background: linear-gradient(135deg, #607d8b, #455a64);
            color: white;
        }

        .stop-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(96, 125, 139, 0.3);
        }

        .play-btn {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .process-btn {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }

        .process-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .next-btn {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }

        /* Navigation Buttons */
        .navigation-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
        }

        /* Analysis Results */
        .analysis-section {
            display: none;
            margin-top: 2rem;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .analysis-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .analysis-card h3 {
            color: #8b4513;
            margin-bottom: 1rem;
        }

        /* Band Score Guidance */
        .band-guidance {
            background: rgba(139, 69, 19, 0.05);
            border-left: 4px solid #d4af37;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 2rem 0;
        }

        .band-guidance h3 {
            color: #8b4513;
            margin-bottom: 1rem;
        }

        .band-criteria {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .criteria-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 1rem;
            border-radius: 8px;
        }

        .criteria-item h4 {
            color: #8b4513;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .content-section {
                padding: 1.5rem 0.5rem;
            }

            .hero-title {
                font-size: 2.2rem;
            }

            .hero-subtitle {
                font-size: 1.2rem;
                padding: 0.8rem 1.5rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .slide-menu {
                width: 100%;
                left: -100%;
            }

            .container {
                margin-left: 0 !important;
            }

            .menu-toggle {
                left: 30px;
            }

            .menu-toggle-label {
                left: 55px;
            }

            .gk-logo-container {
                top: 100px;
                right: 20px;
                padding: 3px;
            }

            .master-guruvammal-logo {
                width: 40px;
                height: 40px;
                font-size: 20px;
                padding: 8px;
            }

            .master-guruvammal-logo .musical-corner {
                font-size: 8px;
                top: 1px;
                right: 2px;
            }

            .back-label {
                font-size: 0.7rem;
            }

            .control-buttons {
                flex-direction: column;
                align-items: center;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .band-criteria {
                grid-template-columns: 1fr;
            }
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Master Guruvammal Logo as Back Button -->
    <div class="gk-logo-container" onclick="handleBackButton()" title="Back to Speaking Introduction">
        <div class="master-guruvammal-logo">
            Ga<span class="musical-corner">P</span>
        </div>
        <div class="back-label">Back</div>
    </div>

    <!-- Menu Toggle Button -->
    <button class="menu-toggle" onclick="toggleMenu()" id="menuToggle">
        ‹
    </button>
    <div class="menu-toggle-label" id="menuToggleLabel">Collapse</div>

    <!-- Slide-out Menu -->
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <div class="menu-bookmark-title">IELTS Speaking Part 3</div>
            <div class="menu-subtitle">Environment & Society - Discussion Practice</div>
        </div>
        <div class="menu-content">
            <div class="menu-item" onclick="scrollToSection('instructions')">📋 Instructions</div>
            <div class="menu-item active" onclick="scrollToSection('discussion')">🗣️ Discussion Questions</div>
            <div class="menu-item" onclick="scrollToSection('recording')">🎙️ Recording Studio</div>
            <div class="menu-item" onclick="scrollToSection('analysis')">📊 Analysis Results</div>
            <div class="menu-item" onclick="scrollToSection('guidance')">🎓 Band Score Guidance</div>
        </div>
    </div>

    <!-- Header Spacer -->
    <div class="header-spacer"></div>

    <!-- Main Container -->
    <div class="container" id="container">
        <div class="main-content">
            <!-- Hero Section -->
            <section class="content-section fade-in" id="instructions">
                <h1 class="hero-title">IELTS General Speaking Part 3: Environment & Society</h1>
                <div class="hero-subtitle">
                    Master environmental discussions with our interactive practice studio
                </div>
                
                <div style="text-align: center; color: #666; font-size: 1.1rem; line-height: 1.8; margin: 2rem 0;">
                    <p><strong>Part 3 Format:</strong> This is a two-way discussion between you and the examiner about abstract topics related to Part 2. You need to give <strong>detailed responses</strong> with examples and explanations. <strong>No preparation time</strong> - respond immediately with depth and analysis.</p>
                </div>

                <!-- Question Selection -->
                <div class="question-selection">
                    <h3 style="color: #8b4513; margin-bottom: 1rem;">Select a Discussion Topic:</h3>
                    <select id="questionSelect" onchange="updateCurrentQuestion()">
                        <option value="1">Climate Change & Global Impact</option>
                        <option value="2">Sustainable Living & Consumption</option>
                        <option value="3">Environmental Protection Policies</option>
                        <option value="4">Green Technology & Innovation</option>
                        <option value="5">Individual vs Collective Action</option>
                        <option value="6">Future Environmental Challenges</option>
                    </select>
                </div>
            </section>

            <!-- Discussion Questions Section -->
            <section class="content-section slide-up" id="discussion">
                <h2 class="section-title">🗣️ Discussion Questions</h2>
                
                <div class="discussion-section" id="discussionContent">
                    <div class="discussion-question active" onclick="selectQuestion(1)">
                        <h4>What are the most serious environmental problems facing the world today?</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> Discuss climate change, pollution, deforestation, biodiversity loss. Provide specific examples, compare regional differences, and explain interconnected effects.
                        </div>
                    </div>
                    
                    <div class="discussion-question" onclick="selectQuestion(2)">
                        <h4>How has climate change affected people's daily lives?</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> Mention extreme weather, food security, health impacts, economic effects. Give concrete examples from different regions and discuss adaptation strategies.
                        </div>
                    </div>
                    
                    <div class="discussion-question" onclick="selectQuestion(3)">
                        <h4>What role should governments play in protecting the environment?</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> Discuss regulation, incentives, international cooperation, policy examples. Consider balance between economic growth and environmental protection.
                        </div>
                    </div>
                    
                    <div class="discussion-question" onclick="selectQuestion(4)">
                        <h4>Can individual actions make a significant difference to environmental problems?</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> Present balanced view - collective impact vs individual responsibility, lifestyle changes, consumer choices, awareness raising.
                        </div>
                    </div>
                    
                    <div class="discussion-question" onclick="selectQuestion(5)">
                        <h4>How can businesses become more environmentally responsible?</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> Discuss sustainable practices, corporate social responsibility, green innovation, stakeholder pressure, economic benefits.
                        </div>
                    </div>
                    
                    <div class="discussion-question" onclick="selectQuestion(6)">
                        <h4>What will be the environmental situation in 50 years if current trends continue?</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> Make realistic predictions based on current data, discuss potential scenarios, mention both challenges and technological solutions.
                        </div>
                    </div>
                </div>

                <!-- Timer Display (for practice timing) -->
                <div class="timer-display">
                    <div class="timer" id="timerDisplay">00:00</div>
                    <div class="timer-label" id="timerLabel">Response Time</div>
                </div>
            </section>

            <!-- Recording Studio Section -->
            <section class="content-section" id="recording">
                <h2 class="section-title">🎙️ Recording Studio</h2>
                
                <div style="text-align: center; color: #666; margin: 1rem 0;">
                    <p>Select a question above and click "Start Recording" to practice your response. Aim for detailed, analytical answers with examples.</p>
                </div>

                <!-- Control Buttons -->
                <div class="control-buttons">
                    <button class="control-btn record-btn" id="recordBtn" onclick="startRecording()">
                        🎤 Start Recording
                    </button>
                    <button class="control-btn stop-btn" id="stopBtn" onclick="stopRecording()" disabled>
                        ⏹️ Stop Recording
                    </button>
                    <button class="control-btn play-btn" id="playBtn" onclick="playRecording()" disabled>
                        ▶️ Play Recording
                    </button>
                    <button class="control-btn process-btn" id="processBtn" onclick="processAudio()" disabled>
                        🔄 Submit for Analysis
                    </button>
                </div>

                <!-- Audio Visualization -->
                <div style="text-align: center; margin: 2rem 0;">
                    <canvas id="audioCanvas" width="400" height="100" style="border: 1px solid #ddd; border-radius: 5px; display: none;"></canvas>
                </div>
            </section>

            <!-- Analysis Results Section -->
            <section class="content-section analysis-section" id="analysis">
                <h2 class="section-title">📊 Analysis Results</h2>
                
                <div class="analysis-grid">
                    <!-- Example Response -->
                    <div class="analysis-card">
                        <h3>📝 Example Response</h3>
                        <div id="transcriptResult" style="background: rgba(139, 69, 19, 0.05); padding: 1rem; border-radius: 8px; border-left: 4px solid #d4af37; font-style: italic; line-height: 1.6;">
                            Your speech transcript will appear here after analysis...
                        </div>
                    </div>
                    
                    <!-- Analysis & Feedback -->
                    <div class="analysis-card">
                        <h3>🎯 Analysis & Feedback</h3>
                        <div id="analysisResult" style="line-height: 1.6;">
                            Detailed analysis and improvement suggestions will appear here...
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="navigation-buttons">
                    <button class="control-btn next-btn" onclick="goToNextQuestion()">
                        ➡️ Next Topic
                    </button>
                    <button class="control-btn next-btn" onclick="refreshCurrentQuestion()">
                        🔄 Retry This Topic
                    </button>
                </div>
            </section>

            <!-- Band Score Guidance -->
            <section class="content-section" id="guidance">
                <h2 class="section-title">🎓 Band Score Guidance</h2>
                
                <div class="band-guidance">
                    <h3>Part 3 Success Strategies for Environment & Society Discussions</h3>
                    <p>To achieve a high band score in Part 3 environmental discussions, focus on these key areas:</p>
                    
                    <div class="band-criteria">
                        <div class="criteria-item">
                            <h4>🗣️ Fluency & Coherence</h4>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                <li>Connect causes and effects clearly</li>
                                <li>Use appropriate environmental discourse markers</li>
                                <li>Present multi-faceted arguments logically</li>
                                <li>Link local and global perspectives smoothly</li>
                            </ul>
                        </div>
                        
                        <div class="criteria-item">
                            <h4>📚 Lexical Resource</h4>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                <li>Use precise environmental terminology</li>
                                <li>Show range of sustainability vocabulary</li>
                                <li>Include scientific and policy language</li>
                                <li>Use appropriate hedging language</li>
                            </ul>
                        </div>
                        
                        <div class="criteria-item">
                            <h4>⚙️ Grammatical Range</h4>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                <li>Use conditional forms for predictions</li>
                                <li>Apply cause and effect structures</li>
                                <li>Include modal verbs for possibility</li>
                                <li>Use passive voice for processes</li>
                            </ul>
                        </div>
                        
                        <div class="criteria-item">
                            <h4>🎯 Pronunciation</h4>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                <li>Clear articulation of scientific terms</li>
                                <li>Appropriate stress for emphasis</li>
                                <li>Natural intonation for warnings/predictions</li>
                                <li>Confident delivery of complex concepts</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 1rem; border-radius: 8px; margin-top: 1.5rem;">
                        <h4 style="color: #8b4513; margin-bottom: 0.5rem;">💡 Environmental Discussion Tips:</h4>
                        <ul style="padding-left: 1.5rem; line-height: 1.6;">
                            <li><strong>Use data appropriately</strong> - Reference general trends but avoid exact statistics</li>
                            <li><strong>Think systemically</strong> - Show understanding of interconnected environmental issues</li>
                            <li><strong>Be realistic</strong> - Balance optimism with acknowledgment of challenges</li>
                            <li><strong>Include multiple scales</strong> - Discuss local, national, and global perspectives</li>
                            <li><strong>Consider stakeholders</strong> - Think about government, business, and individual roles</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Discussion topics data
        const discussionTopics = {
            1: {
                title: "Climate Change & Global Impact",
                questions: [
                    {
                        question: "What are the most serious environmental problems facing the world today?",
                        tips: "Discuss climate change, pollution, deforestation, biodiversity loss. Provide specific examples, compare regional differences, and explain interconnected effects."
                    },
                    {
                        question: "How has climate change affected people's daily lives?",
                        tips: "Mention extreme weather, food security, health impacts, economic effects. Give concrete examples from different regions and discuss adaptation strategies."
                    },
                    {
                        question: "What role should governments play in protecting the environment?",
                        tips: "Discuss regulation, incentives, international cooperation, policy examples. Consider balance between economic growth and environmental protection."
                    },
                    {
                        question: "Can individual actions make a significant difference to environmental problems?",
                        tips: "Present balanced view - collective impact vs individual responsibility, lifestyle changes, consumer choices, awareness raising."
                    },
                    {
                        question: "How can businesses become more environmentally responsible?",
                        tips: "Discuss sustainable practices, corporate social responsibility, green innovation, stakeholder pressure, economic benefits."
                    },
                    {
                        question: "What will be the environmental situation in 50 years if current trends continue?",
                        tips: "Make realistic predictions based on current data, discuss potential scenarios, mention both challenges and technological solutions."
                    }
                ]
            },
            2: {
                title: "Sustainable Living & Consumption",
                questions: [
                    {
                        question: "How can people reduce their environmental footprint in daily life?",
                        tips: "Discuss energy use, transportation, consumption habits, waste reduction. Give practical examples and consider feasibility."
                    },
                    {
                        question: "Is sustainable living more expensive than traditional lifestyles?",
                        tips: "Present balanced view, consider upfront costs vs long-term savings, accessibility issues, government incentives."
                    },
                    {
                        question: "What role does consumer choice play in environmental protection?",
                        tips: "Discuss market influence, sustainable products, ethical consumption, corporate responsibility, supply chain impacts."
                    },
                    {
                        question: "How has the concept of sustainability changed over time?",
                        tips: "Compare past and present attitudes, awareness evolution, technological developments, policy changes."
                    },
                    {
                        question: "Should governments force people to live more sustainably?",
                        tips: "Discuss regulation vs voluntary action, incentives, education, individual rights, effectiveness of different approaches."
                    },
                    {
                        question: "What are the biggest obstacles to sustainable living?",
                        tips: "Mention cost, convenience, infrastructure, awareness, cultural factors, systemic issues."
                    }
                ]
            },
            3: {
                title: "Environmental Protection Policies",
                questions: [
                    {
                        question: "Which environmental policies have been most effective?",
                        tips: "Give examples of successful policies (carbon taxes, protected areas), measure effectiveness, compare different countries."
                    },
                    {
                        question: "How can international cooperation help solve environmental problems?",
                        tips: "Discuss global agreements, shared challenges, technology transfer, coordinated action, enforcement issues."
                    },
                    {
                        question: "Should environmental protection come before economic development?",
                        tips: "Present balanced view, discuss sustainable development, trade-offs, long-term thinking, different country priorities."
                    },
                    {
                        question: "What are the challenges in implementing environmental policies?",
                        tips: "Mention political will, economic interests, public support, enforcement, measurement difficulties."
                    },
                    {
                        question: "How can governments encourage businesses to be more environmentally friendly?",
                        tips: "Discuss regulations, incentives, penalties, reporting requirements, public recognition, market mechanisms."
                    },
                    {
                        question: "What role do local governments play in environmental protection?",
                        tips: "Consider waste management, urban planning, local regulations, community engagement, adaptation measures."
                    }
                ]
            },
            4: {
                title: "Green Technology & Innovation",
                questions: [
                    {
                        question: "How can technology help solve environmental problems?",
                        tips: "Discuss renewable energy, efficiency improvements, monitoring systems, clean transportation, specific examples."
                    },
                    {
                        question: "What are the limitations of relying on technology for environmental solutions?",
                        tips: "Consider costs, accessibility, unintended consequences, behavioral aspects, systemic issues."
                    },
                    {
                        question: "Should governments invest more in green technology research?",
                        tips: "Discuss public vs private investment, innovation needs, urgency of climate action, economic returns."
                    },
                    {
                        question: "How has renewable energy changed in recent years?",
                        tips: "Mention cost reductions, efficiency improvements, scale increases, policy support, remaining challenges."
                    },
                    {
                        question: "Can technology completely solve environmental problems?",
                        tips: "Present realistic view, discuss need for behavioral change, systemic issues, technology's role and limits."
                    },
                    {
                        question: "What environmental technologies will be important in the future?",
                        tips: "Predict based on current trends, mention carbon capture, artificial intelligence, biotechnology, smart systems."
                    }
                ]
            },
            5: {
                title: "Individual vs Collective Action",
                questions: [
                    {
                        question: "What environmental actions should individuals prioritize?",
                        tips: "Discuss high-impact actions (energy, transport, diet), practical considerations, cost-effectiveness."
                    },
                    {
                        question: "How can communities work together on environmental issues?",
                        tips: "Mention local projects, shared resources, collective purchasing, education, political pressure."
                    },
                    {
                        question: "Is it fair to blame individuals for environmental problems?",
                        tips: "Discuss individual responsibility vs systemic issues, corporate influence, policy failures, historical context."
                    },
                    {
                        question: "How can people be motivated to care more about the environment?",
                        tips: "Consider education, personal experience, economic incentives, social pressure, role models, media."
                    },
                    {
                        question: "What role do environmental organizations play in society?",
                        tips: "Discuss awareness raising, lobbying, research, direct action, education, holding institutions accountable."
                    },
                    {
                        question: "How has environmental awareness changed among young people?",
                        tips: "Compare generations, discuss activism, education, social media, future concerns, behavioral changes."
                    }
                ]
            },
            6: {
                title: "Future Environmental Challenges",
                questions: [
                    {
                        question: "What will be the biggest environmental challenges for future generations?",
                        tips: "Predict based on current trends, consider population growth, resource scarcity, climate impacts."
                    },
                    {
                        question: "How might cities need to change to become more sustainable?",
                        tips: "Discuss urban planning, transportation, energy systems, green spaces, waste management, adaptation."
                    },
                    {
                        question: "What role will artificial intelligence play in environmental protection?",
                        tips: "Consider monitoring, optimization, prediction, automation, efficiency improvements, potential risks."
                    },
                    {
                        question: "How will climate change affect global migration patterns?",
                        tips: "Discuss climate refugees, sea level rise, extreme weather, resource conflicts, policy challenges."
                    },
                    {
                        question: "Can humans live sustainably with a growing population?",
                        tips: "Discuss resource efficiency, technological solutions, lifestyle changes, carrying capacity, distribution issues."
                    },
                    {
                        question: "What would happen if we don't address environmental problems soon?",
                        tips: "Discuss potential scenarios, tipping points, irreversible changes, economic costs, social impacts."
                    }
                ]
            }
        };

        // Audio recording variables
        let mediaRecorder;
        let audioChunks = [];
        let originalAudioBlob = null;
        let isRecording = false;
        let timerInterval;
        let recordingStartTime;
        let audioContext;
        let analyser;
        let microphone;
        let dataArray;
        let animationFrameId;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const questionParam = urlParams.get('question');
            
            if (questionParam && discussionTopics[questionParam]) {
                document.getElementById('questionSelect').value = questionParam;
                updateCurrentQuestion();
            }
            
            console.log('✅ IELTS Speaking Part 3 - Environment & Society loaded');
        });

        // Back button navigation
        function handleBackButton() {
            console.log('🔄 Back button clicked from IELTS Speaking Part 3 - Going to Speaking Introduction');
            window.location.href = 'IELTS_General_Speaking_Introduction.html';
        }

        // Menu toggle functionality
        function toggleMenu() {
            const menu = document.getElementById('slideMenu');
            const toggleBtn = document.getElementById('menuToggle');
            const toggleLabel = document.getElementById('menuToggleLabel');
            const container = document.getElementById('container');
            const isCollapsed = menu.classList.contains('collapsed');
            
            if (isCollapsed) {
                menu.classList.remove('collapsed');
                toggleBtn.classList.remove('collapsed');
                toggleLabel.classList.remove('collapsed');
                container.classList.remove('menu-collapsed');
                toggleBtn.innerHTML = '‹';
                toggleLabel.textContent = 'Collapse';
            } else {
                menu.classList.add('collapsed');
                toggleBtn.classList.add('collapsed');
                toggleLabel.classList.add('collapsed');
                container.classList.add('menu-collapsed');
                toggleBtn.innerHTML = '›';
                toggleLabel.textContent = 'Expand';
            }
        }

        // Update discussion content
        function updateCurrentQuestion() {
            const questionSelect = document.getElementById('questionSelect');
            const topicNum = questionSelect.value;
            const topic = discussionTopics[topicNum];
            
            if (topic) {
                const discussionContent = document.getElementById('discussionContent');
                discussionContent.innerHTML = topic.questions.map((q, index) => `
                    <div class="discussion-question ${index === 0 ? 'active' : ''}" onclick="selectQuestion(${index + 1})">
                        <h4>${q.question}</h4>
                        <div class="question-tips">
                            <strong>Tips:</strong> ${q.tips}
                        </div>
                    </div>
                `).join('');
                
                // Reset everything
                resetSession();
                
                // Update URL
                const url = new URL(window.location);
                url.searchParams.set('question', topicNum);
                window.history.pushState({}, '', url.toString());
            }
        }

        // Select question
        function selectQuestion(questionNum) {
            const questions = document.querySelectorAll('.discussion-question');
            questions.forEach((q, index) => {
                q.classList.toggle('active', index === questionNum - 1);
            });
        }

        // Start recording
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: {
                        sampleRate: 44100,
                        channelCount: 1,
                        volume: 1.0
                    } 
                });
                
                // Setup audio context for visualization
                setupAudioVisualization(stream);
                
                mediaRecorder = new MediaRecorder(stream, {
                    mimeType: 'audio/webm;codecs=opus'
                });
                
                audioChunks = [];
                
                mediaRecorder.ondataavailable = event => {
                    if (event.data.size > 0) {
                        audioChunks.push(event.data);
                    }
                };
                
                mediaRecorder.onstop = () => {
                    originalAudioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    document.getElementById('playBtn').disabled = false;
                    document.getElementById('processBtn').disabled = false;
                    
                    // Stop all audio tracks
                    stream.getTracks().forEach(track => track.stop());
                };
                
                mediaRecorder.start();
                isRecording = true;
                recordingStartTime = Date.now();
                
                // Start timer
                timerInterval = setInterval(updateTimer, 100);
                
                // Update button states
                document.getElementById('recordBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                document.getElementById('recordBtn').textContent = '🎤 Recording...';
                
                // Show audio visualization
                document.getElementById('audioCanvas').style.display = 'block';
                
            } catch (error) {
                console.error('Error accessing microphone:', error);
                alert('Error accessing microphone. Please ensure you have granted microphone permissions.');
            }
        }

        // Update timer
        function updateTimer() {
            if (isRecording && recordingStartTime) {
                const elapsed = Math.floor((Date.now() - recordingStartTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Stop recording
        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                isRecording = false;
                
                clearInterval(timerInterval);
                
                // Update button states
                document.getElementById('recordBtn').disabled = false;
                document.getElementById('stopBtn').disabled = true;
                document.getElementById('recordBtn').textContent = '🎤 Start Recording';
                
                // Hide audio visualization
                document.getElementById('audioCanvas').style.display = 'none';
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }
                
                document.getElementById('timerLabel').textContent = 'Recording Complete';
            }
        }

        // Play recorded audio
        function playRecording() {
            if (originalAudioBlob) {
                const audioUrl = URL.createObjectURL(originalAudioBlob);
                const audio = new Audio(audioUrl);
                audio.play();
            }
        }

        // Setup audio visualization
        function setupAudioVisualization(stream) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            analyser = audioContext.createAnalyser();
            microphone = audioContext.createMediaStreamSource(stream);
            
            analyser.fftSize = 256;
            const bufferLength = analyser.frequencyBinCount;
            dataArray = new Uint8Array(bufferLength);
            
            microphone.connect(analyser);
            
            const canvas = document.getElementById('audioCanvas');
            const canvasCtx = canvas.getContext('2d');
            
            function draw() {
                if (!isRecording) return;
                
                analyser.getByteFrequencyData(dataArray);
                
                canvasCtx.fillStyle = 'rgb(240, 240, 240)';
                canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
                
                const barWidth = canvas.width / bufferLength * 2.5;
                let barHeight;
                let x = 0;
                
                for (let i = 0; i < bufferLength; i++) {
                    barHeight = dataArray[i] / 2;
                    
                    const red = 139;
                    const green = 69 + (barHeight / 4);
                    const blue = 19;
                    
                    canvasCtx.fillStyle = `rgb(${red},${green},${blue})`;
                    canvasCtx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
                    
                    x += barWidth + 1;
                }
                
                animationFrameId = requestAnimationFrame(draw);
            }
            
            draw();
        }

        // Process audio for analysis
        function processAudio() {
            if (!originalAudioBlob) {
                alert('Please record audio first.');
                return;
            }
            
            // Show analysis section
            document.querySelector('.analysis-section').style.display = 'block';
            document.getElementById('analysis').scrollIntoView({ behavior: 'smooth' });
            
            // Simulate processing
            const transcriptDiv = document.getElementById('transcriptResult');
            const analysisDiv = document.getElementById('analysisResult');
            
            transcriptDiv.innerHTML = '<div style="text-align: center; color: #666;"><em>🔄 Processing your speech...</em></div>';
            analysisDiv.innerHTML = '<div style="text-align: center; color: #666;"><em>🔄 Analyzing your response...</em></div>';
            
            // Simulate analysis delay
            setTimeout(() => {
                transcriptDiv.innerHTML = `
                    <p><em>"I believe the most pressing environmental challenges we face today are interconnected and urgent. Climate change is perhaps the overarching issue - we're seeing unprecedented temperature increases, melting ice caps, and extreme weather events becoming more frequent and severe. This links directly to biodiversity loss, as ecosystems struggle to adapt to rapid changes. Pollution, particularly plastic waste in our oceans and air quality in major cities, poses immediate health risks. Deforestation continues at alarming rates, reducing our planet's capacity to absorb carbon dioxide. What makes these problems particularly serious is how they compound each other - climate change accelerates species extinction, pollution affects food systems, and environmental degradation often hits the most vulnerable populations hardest."</em></p>
                `;
                
                analysisDiv.innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <h4 style="color: #8b4513; margin-bottom: 0.5rem;">✅ Strengths:</h4>
                        <ul style="color: #2e7d32; padding-left: 1.5rem;">
                            <li>Excellent use of environmental terminology (biodiversity, ecosystems, deforestation)</li>
                            <li>Clear explanation of interconnected environmental issues</li>
                            <li>Specific examples with geographic context (ice caps, oceans, cities)</li>
                            <li>Demonstrates understanding of cause-and-effect relationships</li>
                            <li>Shows social awareness by mentioning vulnerable populations</li>
                        </ul>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <h4 style="color: #8b4513; margin-bottom: 0.5rem;">🎯 Areas for Improvement:</h4>
                        <ul style="color: #d84315; padding-left: 1.5rem;">
                            <li>Could include more specific data or comparative examples</li>
                            <li>Add regional examples to show global vs local perspectives</li>
                            <li>Include potential solutions or mitigation strategies</li>
                            <li>Extend discussion of economic implications</li>
                        </ul>
                    </div>
                    <div style="background: rgba(139, 69, 19, 0.1); padding: 1rem; border-radius: 8px;">
                        <h4 style="color: #8b4513; margin-bottom: 0.5rem;">📊 Estimated Band Score: 8.5-9.0</h4>
                        <p style="font-size: 0.9rem; color: #666; line-height: 1.5;">
                            Outstanding response demonstrating sophisticated understanding of environmental issues with excellent vocabulary and complex sentence structures. Shows clear systemic thinking and awareness of interconnected challenges.
                        </p>
                    </div>
                `;
            }, 2000);
        }

        // Navigation functions
        function goToNextQuestion() {
            const currentTopic = parseInt(document.getElementById('questionSelect').value);
            const nextTopic = currentTopic >= 6 ? 1 : currentTopic + 1;
            document.getElementById('questionSelect').value = nextTopic;
            updateCurrentQuestion();
            document.getElementById('discussion').scrollIntoView({ behavior: 'smooth' });
        }

        function refreshCurrentQuestion() {
            resetSession();
            document.getElementById('instructions').scrollIntoView({ behavior: 'smooth' });
        }

        // Reset session
        function resetSession() {
            // Stop any ongoing recording
            if (isRecording) {
                stopRecording();
            }
            
            // Clear timers
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Reset button states
            document.getElementById('recordBtn').disabled = false;
            document.getElementById('recordBtn').textContent = '🎤 Start Recording';
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('playBtn').disabled = true;
            document.getElementById('processBtn').disabled = true;
            
            // Reset timer display
            document.getElementById('timerDisplay').textContent = '00:00';
            document.getElementById('timerLabel').textContent = 'Response Time';
            
            // Hide analysis section
            document.querySelector('.analysis-section').style.display = 'none';
            
            // Reset variables
            isRecording = false;
            audioChunks = [];
            originalAudioBlob = null;
            recordingStartTime = null;
            
            // Hide audio visualization
            document.getElementById('audioCanvas').style.display = 'none';
        }

        // Scroll to section
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
            
            // Update active menu item
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            event.target.classList.add('active');
        }
    </script>
</body>
</html> 
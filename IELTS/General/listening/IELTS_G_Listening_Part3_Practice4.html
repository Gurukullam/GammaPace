<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS General Listening Part 3 - Practice 4: Travel Planning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(139, 69, 19, 0.2) 50%, rgba(255, 215, 0, 0.1) 100%);
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(139, 69, 19, 0.05) 0%, transparent 50%);
            z-index: -1;
            pointer-events: none;
        }

        /* Header spacing */
        .header-spacer {
            height: 20px;
            width: 100%;
        }

        /* Guruvammal Logo as Back Button */
        .gk-logo-container {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1002;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }

        .master-guruvammal-logo {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            box-sizing: border-box;
            font-family: 'Century Gothic', sans-serif;
            font-size: 26px;
            font-weight: 900;
            letter-spacing: -1px;
            line-height: 1;
            color: #5d3a0a;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(139, 69, 19, 0.25) 50%, rgba(205, 133, 63, 0.2) 100%);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.3), 0 0 40px rgba(212, 175, 55, 0.2);
            z-index: 10000;
            transition: all 0.3s ease;
        }

        .master-guruvammal-logo .musical-corner {
            position: absolute;
            top: 2px;
            right: 3px;
            font-size: 10px;
            color: #5d3a0a;
            font-weight: 900;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
        }

        .master-guruvammal-logo:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(139, 69, 19, 0.4), 0 0 50px rgba(212, 175, 55, 0.3);
        }

        .back-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #8b4513;
            font-family: 'Century Gothic', sans-serif;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
            text-align: center;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover .back-label {
            color: #5d3a0a;
            transform: translateY(-1px);
        }

        /* Container with menu support */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            margin-left: 360px;
            transition: margin-left 0.3s ease;
        }

        .container.menu-collapsed {
            margin-left: 20px;
        }

        /* Main Content */
        .main-content {
            margin-top: 0;
            padding: 1.5rem 2rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Professional Slide-out Menu */
        .slide-menu {
            position: fixed;
            left: 0;
            top: 0;
            width: 340px;
            height: 100vh;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(248, 249, 250, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-right: 3px solid rgba(212, 175, 55, 0.3);
            box-shadow: 8px 0 30px rgba(139, 69, 19, 0.15);
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform: translateX(0);
        }

        .slide-menu.collapsed {
            transform: translateX(-340px);
        }

        .menu-header {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            padding: 2rem 1.5rem 1.5rem;
            border-bottom: 2px solid rgba(139, 69, 19, 0.3);
            position: relative;
            overflow: hidden;
        }

        .menu-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(212, 175, 55, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.15) 0%, transparent 40%);
            pointer-events: none;
        }

        .menu-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .menu-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .menu-content {
            padding: 1.5rem 0;
        }

        .menu-item {
            display: block;
            padding: 1rem 1.5rem;
            text-decoration: none;
            color: #333;
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .menu-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #8b4513, #d4af37);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .menu-item:hover {
            background: rgba(212, 175, 55, 0.08);
            color: #8b4513;
            transform: translateX(8px);
        }

        .menu-item:hover::before {
            transform: scaleY(1);
        }

        .item-title {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .item-description {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.4;
        }

        /* Menu Toggle Button */
        .menu-toggle {
            position: fixed;
            top: 30px;
            left: 360px;
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
            transition: all 0.3s ease;
        }

        .menu-toggle:hover {
            background: linear-gradient(135deg, #d4af37, #ffd700);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }

        .menu-toggle.collapsed {
            left: 30px;
        }

        /* Hero Section */
        .hero-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 3rem 2rem;
            text-align: center;
            margin-bottom: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(139, 69, 19, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .hero-title {
            font-size: 2.8rem;
            font-weight: 900;
            color: #8b4513;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .hero-subtitle {
            font-size: 1.4rem;
            color: #666;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .hero-description {
            font-size: 1.1rem;
            color: #555;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.7;
            position: relative;
            z-index: 1;
        }

        /* Section Styles */
        .content-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #d4af37;
        }

        .section-title {
            color: #8b4513;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            text-align: center;
            border-bottom: 3px solid #d4af37;
            padding-bottom: 0.5rem;
        }

        .speakers-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .speaker-card {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(255, 215, 0, 0.05));
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #d4af37;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .speaker-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
        }

        .speaker-card.active {
            border-color: #8b4513;
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.1), rgba(212, 175, 55, 0.1));
            transform: scale(1.02);
        }

        .speaker-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #5d3a0a;
            margin-bottom: 8px;
        }

        .speaker-role {
            color: #8b4513;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .speaker-details {
            color: #666;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .conversation-context {
            background: rgba(255, 215, 0, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #d4af37;
        }

        /* Audio Player Styles */
        .play-btn {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4);
            margin-bottom: 1rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .play-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #d4af37, #ffd700);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.6);
        }

        .play-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress-container {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 10px;
            padding: 0.5rem;
            margin-top: 1rem;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            background: linear-gradient(90deg, #8b4513, #d4af37);
            height: 100%;
            width: 0%;
            transition: width 0.2s ease;
        }

        .time-display {
            text-align: center;
            font-size: 0.9rem;
            color: #8b4513;
            font-weight: 600;
        }

        .question-group {
            margin-bottom: 35px;
            padding: 20px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: 12px;
            border: 1px solid #d4af37;
        }

        .question-group-title {
            font-size: 1.2em;
            color: #8b4513;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
        }

        .question {
            margin-bottom: 25px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #d4af37;
        }

        .question-number {
            font-weight: bold;
            color: #5d3a0a;
            margin-bottom: 10px;
        }

        .question-text {
            margin-bottom: 15px;
            font-size: 1.05em;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 10px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .option:hover {
            background: rgba(212, 175, 55, 0.1);
            border-color: #d4af37;
        }

        .option input[type="radio"] {
            margin-right: 10px;
            accent-color: #d4af37;
        }

        .note-completion-input {
            background: white;
            border: 2px solid #d4af37;
            border-radius: 6px;
            padding: 8px 12px;
            margin-left: 10px;
            min-width: 150px;
            font-size: 16px;
        }

        .note-completion-input:focus {
            outline: none;
            border-color: #8b4513;
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.3);
        }

        .submit-btn {
            background: linear-gradient(135deg, #8b4513, #5d3a0a);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, #5d3a0a, #8b4513);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }

        .score-display {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(255, 215, 0, 0.05));
            border-radius: 15px;
            border: 2px solid #d4af37;
        }

        .score-number {
            font-size: 3rem;
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 0.5rem;
        }

        .score-text {
            font-size: 1.2rem;
            color: #666;
            margin-top: 0.5rem;
        }

        .answer-review {
            margin-bottom: 2rem;
        }

        .review-item {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }

        .review-item.correct {
            border-left-color: #28a745;
            background: rgba(40, 167, 69, 0.1);
        }

        .review-item.incorrect {
            border-left-color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
        }

        .improvement-tips {
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }

        .improvement-tips h4 {
            color: #8b4513;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .improvement-tips ul {
            list-style: none;
            padding: 0;
        }

        .improvement-tips li {
            margin-bottom: 0.8rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .improvement-tips li::before {
            content: '‚úàÔ∏è';
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Auto-submit popup styles */
        .auto-submit-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .auto-submit-popup {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
            border: 3px solid #d4af37;
            max-width: 500px;
            margin: 20px;
        }

        .auto-submit-title {
            font-size: 1.8rem;
            color: #8b4513;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .auto-submit-message {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .auto-submit-countdown {
            font-size: 2rem;
            color: #d4af37;
            font-weight: bold;
            margin-bottom: 25px;
        }

        .auto-submit-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .auto-submit-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auto-submit-btn.primary {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
        }

        .auto-submit-btn.primary:hover {
            background: linear-gradient(135deg, #d4af37, #ffd700);
            transform: translateY(-2px);
        }

        .auto-submit-btn.secondary {
            background: #f0f0f0;
            color: #333;
            border: 2px solid #d4af37;
        }

        .auto-submit-btn.secondary:hover {
            background: rgba(212, 175, 55, 0.1);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin-left: 20px;
            }

            .slide-menu {
                width: 100%;
                transform: translateX(-100%);
            }

            .slide-menu.active {
                transform: translateX(0);
            }

            .menu-toggle {
                left: 30px;
            }

            .hero-title {
                font-size: 2rem;
            }

            .main-content {
                padding: 1rem;
            }

            .content-section {
                padding: 1.5rem;
            }

            .speakers-container {
                grid-template-columns: 1fr;
            }

            .play-btn {
                width: 90%;
                font-size: 1rem;
                padding: 0.8rem 1.5rem;
            }
        }

        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Selection Styles */
        ::selection {
            background: rgba(212, 175, 55, 0.3);
            color: #8b4513;
        }
    </style>
</head>
<body>
    <div class="header-spacer"></div>

    <!-- Guruvammal Logo as Back Button -->
    <div class="gk-logo-container" onclick="handleBackButton()">
        <div class="master-guruvammal-logo">
            Ga<span class="musical-corner">‚ô™</span>
        </div>
        <div class="back-label">Back</div>
    </div>

    <!-- Professional Slide-out Menu -->
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <div class="menu-title">‚úàÔ∏è IELTS General Listening</div>
            <div class="menu-subtitle">Part 3 - Practice 4</div>
        </div>
        <div class="menu-content">
            <a href="#speakers" class="menu-item" onclick="navigateToSection('speakers')">
                <div class="item-title">1. Travel Planning Team</div>
                <div class="item-description">üë• Trip Organizer, Budget Coordinator & Activities Planner</div>
            </a>
            <a href="#audio-section" class="menu-item" onclick="navigateToSection('audio-section')">
                <div class="item-title">2. Travel Planning</div>
                <div class="item-description">üéß Thailand Group Holiday Discussion (5 min)</div>
            </a>
            <a href="#questions" class="menu-item" onclick="navigateToSection('questions')">
                <div class="item-title">3. Questions (Part 3)</div>
                <div class="item-description">üìù Note Completion + Multiple Choice</div>
            </a>
            <a href="#results" class="menu-item" onclick="navigateToSection('results')">
                <div class="item-title">4. Results & Analysis</div>
                <div class="item-description">üìä Performance Feedback & Improvement Tips</div>
            </a>
        </div>
    </div>

    <!-- Menu Toggle Button -->
    <div class="menu-toggle" id="menuToggle" onclick="toggleMenu()">
        <span id="menuIcon">üìã</span>
    </div>

    <!-- Main Container -->
    <div class="container" id="container">
        <main class="main-content">
            <!-- Hero Section -->
            <section class="hero-section">
                <h1 class="hero-title">‚úàÔ∏è IELTS General Listening - Part 3 (Practice 4)</h1>
                <div class="hero-subtitle">
                    Travel Planning - Group Holiday
                </div>
                <p class="hero-description">
                    Listen to Alex Thompson (Trip Organizer), Maria Santos (Budget Coordinator), and Ryan Kelly (Activities Planner) organizing a group vacation to Thailand. This conversation covers destination planning, budget management, accommodation booking, and activity coordination. Complete note completion and multiple choice questions about their travel planning discussion. This practice covers Questions 21-30.
                </p>
            </section>

            <section id="speakers" class="content-section">
                <h2 class="section-title">üë• Travel Planning Team</h2>
                <div class="speakers-container">
                    <div class="speaker-card" id="speaker1">
                        <div class="speaker-name">Alex Thompson</div>
                        <div class="speaker-role">Trip Organizer | Main Coordinator</div>
                        <div class="speaker-details">
                            <strong>Accent:</strong> Australian English<br>
                            <strong>Role:</strong> Main trip organizer and coordinator<br>
                            <strong>Experience:</strong> Experienced traveler with group planning skills<br>
                            <strong>Responsibility:</strong> Overall itinerary and logistics coordination
                        </div>
                    </div>
                    <div class="speaker-card" id="speaker2">
                        <div class="speaker-name">Maria Santos</div>
                        <div class="speaker-role">Budget Coordinator | Financial Planner</div>
                        <div class="speaker-details">
                            <strong>Accent:</strong> American English<br>
                            <strong>Role:</strong> Group budget manager and financial coordinator<br>
                            <strong>Focus:</strong> Cost management and expense tracking<br>
                            <strong>Responsibility:</strong> Budget planning and cost-effective solutions
                        </div>
                    </div>
                    <div class="speaker-card" id="speaker3">
                        <div class="speaker-name">Ryan Kelly</div>
                        <div class="speaker-role">Activities Planner | Experience Coordinator</div>
                        <div class="speaker-details">
                            <strong>Accent:</strong> British English<br>
                            <strong>Role:</strong> Activities and experiences planner<br>
                            <strong>Interest:</strong> Adventure activities and cultural experiences<br>
                            <strong>Responsibility:</strong> Activity research and booking coordination
                        </div>
                    </div>
                </div>
            </section>

            <section id="audio-section" class="content-section">
                <h2 class="section-title">üéß Travel Planning Discussion</h2>
                <div class="conversation-context">
                    <strong>Travel Planning Context:</strong> Friends organizing a group vacation to Thailand covering destination selection, accommodation booking, budget management, activity planning, and travel logistics. The discussion involves collaborative planning for an international group holiday with multiple considerations and preferences.
                </div>
                
                <button class="play-btn" onclick="playAudio()" id="playBtn">
                    ‚ñ∂Ô∏è Play
                </button>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="time-display">
                        <span id="currentTime">00:00</span> / <span id="totalTime">06:30</span>
                    </div>
                </div>
                
                <div id="currentSpeaker" style="text-align: center; margin-top: 15px; font-weight: bold; color: #8b4513;"></div>
            </section>

            <section id="questions" class="content-section">
                <h2 class="section-title">üìù Travel Planning Assessment</h2>
                
                <!-- Note Completion Questions (Questions 21-26) -->
                <div class="question-group">
                    <h3 class="question-group-title">Questions 21-26: Note Completion</h3>
                    <p><em>Complete the notes below using NO MORE THAN TWO WORDS for each answer.</em></p>
                    
                    <div class="question">
                        <div class="question-number">Question 21</div>
                        <div class="question-text">
                            The group will travel to Thailand in 
                            <input type="text" class="note-completion-input" id="q21" placeholder="21">
                            when the weather is most suitable for outdoor activities.
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 22</div>
                        <div class="question-text">
                            Total trip budget per person is approximately 
                            <input type="text" class="note-completion-input" id="q22" placeholder="22">
                            dollars including flights and accommodation.
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 23</div>
                        <div class="question-text">
                            They will stay at a 
                            <input type="text" class="note-completion-input" id="q23" placeholder="23">
                            located near the beach with good reviews from previous guests.
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 24</div>
                        <div class="question-text">
                            The most popular activity they plan to do is 
                            <input type="text" class="note-completion-input" id="q24" placeholder="24">
                            in the crystal clear waters around the islands.
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 25</div>
                        <div class="question-text">
                            For cultural experiences, they want to visit local 
                            <input type="text" class="note-completion-input" id="q25" placeholder="25">
                            to learn about Thai traditions and history.
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 26</div>
                        <div class="question-text">
                            The group will book their flights through a 
                            <input type="text" class="note-completion-input" id="q26" placeholder="26">
                            to get better group rates and flexible booking options.
                        </div>
                    </div>
                </div>

                <!-- Multiple Choice Questions (Questions 27-30) -->
                <div class="question-group">
                    <h3 class="question-group-title">Questions 27-30: Multiple Choice</h3>
                    <p><em>Choose the correct letter, A, B or C.</em></p>
                    
                    <div class="question">
                        <div class="question-number">Question 27</div>
                        <div class="question-text">What is the main concern about the accommodation?</div>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q27" value="A" id="q27a">
                                <label for="q27a">A) The location is too far from main attractions</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q27" value="B" id="q27b">
                                <label for="q27b">B) The rooms might not be available for all dates</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q27" value="C" id="q27c">
                                <label for="q27c">C) The price has increased since they first checked</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 28</div>
                        <div class="question-text">According to Ryan, what activity should be avoided?</div>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q28" value="A" id="q28a">
                                <label for="q28a">A) Rock climbing due to safety concerns</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q28" value="B" id="q28b">
                                <label for="q28b">B) Elephant trekking for ethical reasons</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q28" value="C" id="q28c">
                                <label for="q28c">C) Deep sea fishing due to weather conditions</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 29</div>
                        <div class="question-text">How will the group manage their daily expenses?</div>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q29" value="A" id="q29a">
                                <label for="q29a">A) Each person pays for their own meals and activities</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q29" value="B" id="q29b">
                                <label for="q29b">B) Pool money together for shared expenses</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q29" value="C" id="q29c">
                                <label for="q29c">C) Use a group credit card for all purchases</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-number">Question 30</div>
                        <div class="question-text">When will they finalize the booking details?</div>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q30" value="A" id="q30a">
                                <label for="q30a">A) By the end of this week</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q30" value="B" id="q30b">
                                <label for="q30b">B) After getting approval from all group members</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q30" value="C" id="q30c">
                                <label for="q30c">C) Once they receive the final quotes</label>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="submit-btn" onclick="submitAnswers()">Submit Answers</button>
            </section>

            <section id="results" class="content-section" style="display: none;">
                <h2 class="section-title">üìä Results & Performance Analysis</h2>
                
                <div class="score-display">
                    <div class="score-number" id="scoreNumber">0</div>
                    <div class="score-text">out of 10 questions correct</div>
                </div>

                <div class="answer-review" id="answerReview">
                    <!-- Answer review will be populated by JavaScript -->
                </div>

                <div class="improvement-tips">
                    <h4>‚úàÔ∏è General Part 3 Improvement Tips</h4>
                    <ul id="improvementList">
                        <!-- Tips will be populated by JavaScript -->
                    </ul>
                </div>
            </section>
        </main>
    </div>

    <!-- Auto-submit Timer Popup -->
    <div class="auto-submit-overlay" id="autoSubmitOverlay">
        <div class="auto-submit-popup">
            <div class="auto-submit-title">‚è∞ Time Completed!</div>
            <div class="auto-submit-message">
                The listening time has finished. You should submit your answers now as this simulates the real IELTS test conditions.
            </div>
            <div class="auto-submit-countdown" id="autoSubmitCountdown">10</div>
            <div class="auto-submit-buttons">
                <button class="auto-submit-btn primary" onclick="handleAutoSubmit()">Submit Now</button>
                <button class="auto-submit-btn secondary" onclick="continueWithoutSubmit()">Continue Working</button>
            </div>
        </div>
    </div>

    <script>
        // Travel planning conversation data with enhanced TTS integration
        const conversationData = [
            {
                speaker: "Alex Thompson",
                text: "Right, let's finalize our Thailand trip plans. I've been doing some research, and I think February would be the perfect time to travel. The weather is most suitable for outdoor activities, and it's not peak tourist season yet.",
                duration: 16000
            },
            {
                speaker: "Maria Santos",
                text: "That sounds great, Alex. I've been working on the budget, and I think we can manage about fifteen hundred dollars per person including flights and accommodation. That should cover most of our expenses comfortably.",
                duration: 13000
            },
            {
                speaker: "Ryan Kelly",
                text: "Fifteen hundred sounds reasonable. I've been looking at accommodation options, and I found this amazing beach resort that has excellent reviews. The only concern is that the rooms might not be available for all our dates.",
                duration: 12000
            },
            {
                speaker: "Alex Thompson",
                text: "We should book soon then. What kind of accommodation is it exactly? I want to make sure it fits our group's needs and preferences.",
                duration: 8000
            },
            {
                speaker: "Ryan Kelly",
                text: "It's a beach resort located near the beach with good reviews from previous guests. The location is perfect - close to restaurants, shops, and easy access to the water for activities.",
                duration: 10000
            },
            {
                speaker: "Maria Santos",
                text: "Speaking of activities, what are we planning to do there? I know some of you are really into water sports and adventure activities.",
                duration: 8000
            },
            {
                speaker: "Ryan Kelly",
                text: "The most popular activity we plan to do is snorkeling in the crystal clear waters around the islands. The underwater visibility is supposed to be incredible, and there's amazing marine life to see.",
                duration: 12000
            },
            {
                speaker: "Alex Thompson",
                text: "That sounds fantastic! I'm also interested in some cultural experiences. We should visit local temples to learn about Thai traditions and history. It would be educational and really enriching.",
                duration: 11000
            },
            {
                speaker: "Ryan Kelly",
                text: "Absolutely! Though I should mention, there's one activity I think we should avoid. Elephant trekking for ethical reasons. There are concerns about animal welfare, and I'd rather we choose more responsible tourism options.",
                duration: 13000
            },
            {
                speaker: "Maria Santos",
                text: "I completely agree with Ryan on that. Now, about managing our daily expenses - I suggest we pool money together for shared expenses like group meals and activities. It makes splitting costs much easier.",
                duration: 12000
            },
            {
                speaker: "Alex Thompson",
                text: "Good idea, Maria. For booking flights, I think we should go through a travel agent to get better group rates and flexible booking options. They can handle all the coordination for us.",
                duration: 10000
            },
            {
                speaker: "Ryan Kelly",
                text: "That makes sense. Travel agents often have access to group discounts that we can't get booking individually online. Plus, they can help if we need to make any changes.",
                duration: 9000
            },
            {
                speaker: "Maria Santos",
                text: "Perfect! So when should we finalize everything? I want to make sure we get the best deals and don't miss out on availability.",
                duration: 8000
            },
            {
                speaker: "Alex Thompson",
                text: "I think we should finalize the booking details once we receive the final quotes from the travel agent and accommodation. That way we can compare all our options and make the best decision for the group.",
                duration: 12000
            },
            {
                speaker: "pause",
                text: "",
                duration: 3000
            }
        ];

        // Audio control variables
        let currentIndex = 0;
        let isPlaying = false;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        // Optimized audio timing for 5-minute content with natural flow
        let totalDuration = conversationData.reduce((sum, item) => sum + item.duration, 0) + 90000; // Add 1.5 minutes for pauses and natural flow
        let currentTime = 0;
        let audioInterval;
        let autoSubmitInterval;
        let autoSubmitCountdown = 10;

        // Voice configuration for different speakers
        const voiceConfig = {
            "Alex Thompson": {
                rate: 0.85,
                pitch: 0.95,
                volume: 0.9,
                lang: 'en-AU'
            },
            "Maria Santos": {
                rate: 0.9,
                pitch: 1.0,
                volume: 0.9,
                lang: 'en-US'
            },
            "Ryan Kelly": {
                rate: 0.8,
                pitch: 0.9,
                volume: 0.9,
                lang: 'en-GB'
            }
        };

        function highlightCurrentSpeaker(speakerName) {
            // Reset all speaker cards
            document.querySelectorAll('.speaker-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Handle pause or end of conversation
            if (speakerName === "pause" || !speakerName) {
                document.getElementById('currentSpeaker').textContent = '‚è∏Ô∏è Travel planning discussion pausing...';
                return;
            }
            
            // Highlight current speaker
            if (speakerName === "Alex Thompson") {
                document.getElementById('speaker1').classList.add('active');
                document.getElementById('currentSpeaker').textContent = `üó£Ô∏è Currently speaking: Alex (Trip Organizer)`;
            } else if (speakerName === "Maria Santos") {
                document.getElementById('speaker2').classList.add('active');
                document.getElementById('currentSpeaker').textContent = `üó£Ô∏è Currently speaking: Maria (Budget Coordinator)`;
            } else if (speakerName === "Ryan Kelly") {
                document.getElementById('speaker3').classList.add('active');
                document.getElementById('currentSpeaker').textContent = `üó£Ô∏è Currently speaking: Ryan (Activities Planner)`;
            }
        }

        function updateProgress() {
            if (isPlaying) {
                currentTime += 100;
                const progress = Math.min((currentTime / totalDuration) * 100, 100);
                document.getElementById('progressFill').style.width = progress + '%';
                
                // Update time display
                const currentMinutes = Math.floor(currentTime / 60000);
                const currentSeconds = Math.floor((currentTime % 60000) / 1000);
                document.getElementById('currentTime').textContent = 
                    `${currentMinutes.toString().padStart(2, '0')}:${currentSeconds.toString().padStart(2, '0')}`;
                
                // Check if time is completed (when progress reaches 100%)
                if (currentTime >= totalDuration) {
                    console.log('‚è∞ Timer completed - showing auto-submit popup');
                    showAutoSubmitPopup();
                }
            }
        }

        function formatTime(milliseconds) {
            const minutes = Math.floor(milliseconds / 60000);
            const seconds = Math.floor((milliseconds % 60000) / 1000);
            return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function playAudio() {
            if (currentIndex >= conversationData.length) {
                currentIndex = 0;
                currentTime = 0;
            }
            
            isPlaying = true;
            document.getElementById('playBtn').disabled = true;
            document.getElementById('playBtn').textContent = 'üîä Playing...';
            
            audioInterval = setInterval(updateProgress, 100);
            playCurrentSegment();
        }

        function playCurrentSegment() {
            if (!isPlaying) {
                return;
            }
            
            if (currentIndex >= conversationData.length) {
                console.log('üéØ Reached end of conversation data');
                stopAudio();
                return;
            }

            const segment = conversationData[currentIndex];
            
            // Handle pause segments
            if (segment.speaker === "pause") {
                console.log(`‚è∏Ô∏è Playing pause segment ${currentIndex + 1} for ${segment.duration}ms`);
                highlightCurrentSpeaker("pause");
                currentIndex++;
                setTimeout(() => {
                    if (isPlaying) {
                        if (currentIndex < conversationData.length) {
                            playCurrentSegment();
                        } else {
                            console.log('üéØ All conversation segments completed after pause');
                            stopAudio();
                        }
                    }
                }, segment.duration);
                return;
            }

            highlightCurrentSpeaker(segment.speaker);

            // Create speech utterance
            currentUtterance = new SpeechSynthesisUtterance(segment.text);
            
            // Apply voice configuration
            const config = voiceConfig[segment.speaker];
            if (config) {
                currentUtterance.rate = config.rate;
                currentUtterance.pitch = config.pitch;
                currentUtterance.volume = config.volume;
                currentUtterance.lang = config.lang;
            }

            // Set voice based on language and speaker
            const voices = speechSynthesis.getVoices();
            if (segment.speaker === "Alex Thompson") {
                const australianVoice = voices.find(voice => 
                    voice.lang.includes('en-AU') && voice.name.toLowerCase().includes('male')
                ) || voices.find(voice => voice.lang.includes('en-AU'));
                if (australianVoice) currentUtterance.voice = australianVoice;
            } else if (segment.speaker === "Maria Santos") {
                const americanVoice = voices.find(voice => 
                    voice.lang.includes('en-US') && voice.name.toLowerCase().includes('female')
                ) || voices.find(voice => voice.lang.includes('en-US'));
                if (americanVoice) currentUtterance.voice = americanVoice;
            } else if (segment.speaker === "Ryan Kelly") {
                const britishVoice = voices.find(voice => 
                    voice.lang.includes('en-GB') && voice.name.toLowerCase().includes('male')
                ) || voices.find(voice => voice.lang.includes('en-GB'));
                if (britishVoice) currentUtterance.voice = britishVoice;
            }

            currentUtterance.onstart = () => {
                console.log(`üé§ Started segment ${currentIndex + 1}: ${segment.speaker}`);
            };

            currentUtterance.onend = () => {
                console.log(`‚úÖ Completed segment ${currentIndex + 1}: ${segment.speaker}`);
                currentIndex++;
                // Add natural pause between speakers (2 seconds for travel conversation)
                setTimeout(() => {
                    if (isPlaying) {
                        if (currentIndex < conversationData.length) {
                            playCurrentSegment();
                        } else {
                            console.log('üéØ All conversation segments completed');
                            stopAudio();
                        }
                    }
                }, 2000);
            };

            currentUtterance.onerror = (event) => {
                console.error(`‚ùå Error in segment ${currentIndex + 1}:`, event.error);
                // Continue to next segment on error
                currentIndex++;
                setTimeout(() => {
                    if (isPlaying && currentIndex < conversationData.length) {
                        playCurrentSegment();
                    } else {
                        stopAudio();
                    }
                }, 1000);
            };

            try {
                speechSynthesis.speak(currentUtterance);
            } catch (error) {
                console.error(`‚ùå Failed to start TTS for segment ${currentIndex + 1}:`, error);
                // Continue to next segment
                currentIndex++;
                setTimeout(() => {
                    if (isPlaying && currentIndex < conversationData.length) {
                        playCurrentSegment();
                    } else {
                        stopAudio();
                    }
                }, 1000);
            }
        }

        function stopAudio() {
            isPlaying = false;
            speechSynthesis.cancel();
            clearInterval(audioInterval);
            
            // Show completion message if audio played to the end
            if (currentIndex >= conversationData.length) {
                document.getElementById('currentSpeaker').textContent = '‚úÖ Travel planning discussion completed. You may now answer the questions.';
                setTimeout(() => {
                    document.getElementById('currentSpeaker').textContent = '';
                }, 3000);
            } else {
                document.getElementById('currentSpeaker').textContent = '';
            }
            
            currentIndex = 0;
            currentTime = 0;
            
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('currentTime').textContent = '00:00';
            document.querySelectorAll('.speaker-card').forEach(card => {
                card.classList.remove('active');
            });
            
            document.getElementById('playBtn').disabled = false;
            document.getElementById('playBtn').textContent = '‚ñ∂Ô∏è Play';
        }

        // Correct answers for assessment
        const correctAnswers = {
            q21: 'february', // travel to Thailand in February
            q22: 'fifteen hundred', // 1500 dollars per person (accepting variations)
            q23: 'beach resort', // stay at a beach resort
            q24: 'snorkeling', // snorkeling in the crystal clear waters
            q25: 'temples', // visit local temples
            q26: 'travel agent', // book flights through a travel agent
            q27: 'B', // The rooms might not be available for all dates
            q28: 'B', // Elephant trekking for ethical reasons
            q29: 'B', // Pool money together for shared expenses
            q30: 'C'  // Once they receive the final quotes
        };

        // Question explanations
        const explanations = {
            q21: 'Alex states: "I think February would be the perfect time to travel. The weather is most suitable for outdoor activities."',
            q22: 'Maria explains: "I think we can manage about fifteen hundred dollars per person including flights and accommodation."',
            q23: 'Ryan mentions: "It\'s a beach resort located near the beach with good reviews from previous guests."',
            q24: 'Ryan explains: "The most popular activity we plan to do is snorkeling in the crystal clear waters around the islands."',
            q25: 'Alex suggests: "We should visit local temples to learn about Thai traditions and history."',
            q26: 'Alex recommends: "I think we should go through a travel agent to get better group rates and flexible booking options."',
            q27: 'Ryan expresses concern: "The only concern is that the rooms might not be available for all our dates."',
            q28: 'Ryan states: "There\'s one activity I think we should avoid. Elephant trekking for ethical reasons."',
            q29: 'Maria suggests: "I suggest we pool money together for shared expenses like group meals and activities."',
            q30: 'Alex concludes: "We should finalize the booking details once we receive the final quotes from the travel agent and accommodation."'
        };

        function submitAnswers() {
            let score = 0;
            const answers = {};
            const reviewHTML = [];
            
            // Check note completion questions (21-26)
            for (let i = 21; i <= 26; i++) {
                const questionName = `q${i}`;
                const answer = document.getElementById(questionName).value.trim().toLowerCase();
                answers[questionName] = answer;
                
                const correct = correctAnswers[questionName].toLowerCase();
                const isCorrect = answer === correct || 
                    (correct.includes(' ') && correct.split(' ').some(word => answer.includes(word))) ||
                    (questionName === 'q22' && (answer.includes('1500') || answer.includes('fifteen hundred'))) ||
                    answer.includes(correct);
                if (isCorrect) score++;
                
                reviewHTML.push(`
                    <div class="review-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <strong>Question ${i}:</strong> ${isCorrect ? '‚úÖ' : '‚ùå'}<br>
                        <strong>Your answer:</strong> ${answer || '<em>No answer</em>'}<br>
                        <strong>Correct answer:</strong> ${correctAnswers[questionName]}<br>
                        <strong>Explanation:</strong> ${explanations[questionName]}
                    </div>
                `);
            }

            // Check multiple choice questions (27-30)
            for (let i = 27; i <= 30; i++) {
                const questionName = `q${i}`;
                const selectedOption = document.querySelector(`input[name="${questionName}"]:checked`);
                const answer = selectedOption ? selectedOption.value : '';
                answers[questionName] = answer;
                
                const correct = correctAnswers[questionName];
                const isCorrect = answer === correct;
                if (isCorrect) score++;
                
                reviewHTML.push(`
                    <div class="review-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <strong>Question ${i}:</strong> ${isCorrect ? '‚úÖ' : '‚ùå'}<br>
                        <strong>Your answer:</strong> ${answer || '<em>No answer</em>'}<br>
                        <strong>Correct answer:</strong> ${correctAnswers[questionName]}<br>
                        <strong>Explanation:</strong> ${explanations[questionName]}
                    </div>
                `);
            }
            
            // Update score display
            document.getElementById('scoreNumber').textContent = score;
            document.getElementById('answerReview').innerHTML = reviewHTML.join('');
            
            // Generate improvement tips
            const tips = generateImprovementTips(score);
            const tipsHTML = tips.map(tip => `<li>${tip}</li>`).join('');
            document.getElementById('improvementList').innerHTML = tipsHTML;
            
            // Show results section
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }

        function generateImprovementTips(score) {
            const tips = [];
            
            if (score <= 3) {
                tips.push("Focus on listening for specific travel planning details and logistics coordination");
                tips.push("Practice understanding travel and tourism vocabulary in planning contexts");
                tips.push("Work on following multi-speaker travel discussions and decision-making processes");
                tips.push("Listen to travel planning conversations and group coordination discussions");
            } else if (score <= 6) {
                tips.push("Develop better note completion skills with travel and destination planning vocabulary");
                tips.push("Practice identifying specific details about budgets, timelines, and activities");
                tips.push("Work on understanding different opinions and preferences in group travel planning");
                tips.push("Focus on travel industry terminology and accommodation vocabulary");
            } else if (score <= 8) {
                tips.push("Fine-tune your ability to distinguish between different planning roles and responsibilities");
                tips.push("Practice capturing exact details about costs, dates, and specific arrangements");
                tips.push("Work on understanding ethical and practical considerations in travel planning");
                tips.push("Review vocabulary related to travel, accommodation, and group coordination");
            } else {
                tips.push("Excellent work! Continue practicing with authentic IELTS General Part 3 materials");
                tips.push("Focus on time management to complete both note completion and multiple choice efficiently");
                tips.push("Practice with different travel and planning contexts and group decision scenarios");
                tips.push("Consider helping others to reinforce your own travel planning listening skills");
            }
            
            return tips;
        }

        // Auto-submit timer functions
        function showAutoSubmitPopup() {
            // Stop audio and clear intervals
            isPlaying = false;
            speechSynthesis.cancel();
            clearInterval(audioInterval);
            
            // Show the popup
            document.getElementById('autoSubmitOverlay').style.display = 'flex';
            
            // Reset countdown
            autoSubmitCountdown = 10;
            document.getElementById('autoSubmitCountdown').textContent = autoSubmitCountdown;
            
            // Start countdown
            autoSubmitInterval = setInterval(() => {
                autoSubmitCountdown--;
                document.getElementById('autoSubmitCountdown').textContent = autoSubmitCountdown;
                
                if (autoSubmitCountdown <= 0) {
                    clearInterval(autoSubmitInterval);
                    handleAutoSubmit();
                }
            }, 1000);
        }

        function handleAutoSubmit() {
            clearInterval(autoSubmitInterval);
            document.getElementById('autoSubmitOverlay').style.display = 'none';
            
            // Automatically submit answers
            submitAnswers();
            
            // Show message
            setTimeout(() => {
                alert('‚è∞ Time completed! Your answers have been automatically submitted as per IELTS test conditions.');
            }, 500);
        }

        function continueWithoutSubmit() {
            clearInterval(autoSubmitInterval);
            document.getElementById('autoSubmitOverlay').style.display = 'none';
            
            // Allow user to continue working
            console.log('üìù User chose to continue working after timer completion');
        }

        // Navigation and menu functions
        function handleBackButton() {
            console.log('üîÑ Back button clicked from IELTS General Listening Part 3 Practice 4 - Going to introduction');
            window.location.href = 'IELTS_General_Listening_Introduction.html';
        }

        function toggleMenu() {
            const menu = document.getElementById('slideMenu');
            const container = document.getElementById('container');
            const menuToggle = document.getElementById('menuToggle');
            
            menu.classList.toggle('collapsed');
            container.classList.toggle('menu-collapsed');
            menuToggle.classList.toggle('collapsed');
        }

        function navigateToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
            
            // Auto-collapse menu on mobile
            if (window.innerWidth <= 768) {
                toggleMenu();
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                handleBackButton();
            } else if (event.code === 'Space' && !isPlaying) {
                event.preventDefault();
                playAudio();
            } else if (event.ctrlKey && event.key === 'Tab') {
                event.preventDefault();
                toggleMenu();
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úàÔ∏è IELTS General Listening Part 3 Practice 4 - Travel Planning loaded');
            
            // Debug audio system
            console.log('üîä Browser audio capabilities:');
            console.log('- speechSynthesis available:', 'speechSynthesis' in window);
            console.log('- Web Audio API available:', 'AudioContext' in window || 'webkitAudioContext' in window);
            
            // Test speech synthesis availability
            if ('speechSynthesis' in window) {
                setTimeout(() => {
                    const voices = speechSynthesis.getVoices();
                    console.log('üé§ Initial voices check:', voices.length, 'voices available');
                    if (voices.length === 0) {
                        console.log('‚è≥ Waiting for voices to load...');
                        speechSynthesis.addEventListener('voiceschanged', function() {
                            const newVoices = speechSynthesis.getVoices();
                            console.log('üé§ Voices loaded:', newVoices.length, 'voices now available');
                        });
                    }
                }, 1000);
            }
            
            // Set total time display
            document.getElementById('totalTime').textContent = formatTime(totalDuration);
        });

        // Clean up on page unload
        window.addEventListener('beforeunload', function() {
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
            }
            if (audioInterval) {
                clearInterval(audioInterval);
            }
            if (autoSubmitInterval) {
                clearInterval(autoSubmitInterval);
            }
        });
    </script>
</body>
</html> 
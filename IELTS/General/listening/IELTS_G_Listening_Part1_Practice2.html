<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS General Listening Part 1 - Practice 2 | GK Foundation</title>
    
    <!-- Font Awesome CSS (Embedded for self-contained operation) -->
    <style>
        /* Font Awesome 6.4.0 - Core icons embedded for self-contained operation */
        .fas, .far, .fab {
            font-family: "Font Awesome 6 Free", "Font Awesome 6 Brands";
            font-weight: 900;
            font-style: normal;
            text-rendering: auto;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Core icons used in this page */
        .fa-graduation-cap:before { content: "\f19d"; }
        .fa-headphones:before { content: "\f025"; }
        .fa-play:before { content: "\f04b"; }
        .fa-pause:before { content: "\f04c"; }
        .fa-stop:before { content: "\f04d"; }
        .fa-volume-up:before { content: "\f028"; }
        .fa-clock:before { content: "\f017"; }
        .fa-edit:before { content: "\f044"; }
        .fa-check-circle:before { content: "\f058"; }
        .fa-times-circle:before { content: "\f057"; }
        .fa-bars:before { content: "\f0c9"; }
        .fa-times:before { content: "\f00d"; }
        .fa-chevron-right:before { content: "\f054"; }
        .fa-chevron-left:before { content: "\f053"; }
        .fa-home:before { content: "\f015"; }
        .fa-star:before { content: "\f005"; }
        .fa-trophy:before { content: "\f091"; }
        .fa-lightbulb:before { content: "\f0eb"; }
        .fa-exclamation-triangle:before { content: "\f071"; }
    </style>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(139, 69, 19, 0.2) 50%, rgba(255, 215, 0, 0.1) 100%);
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(139, 69, 19, 0.05) 0%, transparent 50%);
            z-index: -1;
            pointer-events: none;
        }

        /* Header spacing */
        .header-spacer {
            height: 20px;
            width: 100%;
        }

        /* Guruvammal Logo as Back Button */
        .gk-logo-container {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1002;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }

        .master-guruvammal-logo {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            box-sizing: border-box;
            font-family: 'Century Gothic', sans-serif;
            font-size: 26px;
            font-weight: 900;
            letter-spacing: -1px;
            line-height: 1;
            color: #5d3a0a;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(139, 69, 19, 0.25) 50%, rgba(205, 133, 63, 0.2) 100%);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.3), 0 0 40px rgba(212, 175, 55, 0.2);
            z-index: 10000;
            transition: all 0.3s ease;
        }

        .master-guruvammal-logo .musical-corner {
            position: absolute;
            top: 3px;
            right: 4px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: transparent;
            border: 1px solid #5d3a0a;
            color: #5d3a0a;
            font-family: 'Century Gothic', sans-serif;
            font-size: 7px;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
            box-shadow: none;
        }

        .master-guruvammal-logo:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(139, 69, 19, 0.4), 0 0 50px rgba(212, 175, 55, 0.3);
        }

        .back-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #8b4513;
            font-family: 'Century Gothic', sans-serif;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
            text-align: center;
            transition: all 0.3s ease;
        }

        .gk-logo-container:hover .back-label {
            color: #5d3a0a;
            transform: translateY(-1px);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            margin-left: 360px;
            transition: margin-left 0.3s ease;
        }

        .container.menu-collapsed {
            margin-left: 20px;
        }

        /* Main Content */
        .main-content {
            margin-top: 0;
            padding: 1.5rem 2rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Menu Toggle Button */
        .menu-toggle {
            position: fixed;
            top: 30px;
            left: 360px;
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 0.8rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .menu-toggle-label {
            position: fixed;
            top: 85px;
            left: 382px;
            background: rgba(139, 69, 19, 0.9);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 8px rgba(139, 69, 19, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
            min-width: 45px;
            transform: translateX(-50%);
            pointer-events: none;
        }

        .menu-toggle:hover {
            background: linear-gradient(135deg, #a0522d, #8b4513);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
        }

        .menu-toggle.collapsed {
            left: 20px;
        }

        .menu-toggle-label.collapsed {
            left: 42px;
        }

        /* Slide-out Menu */
        .slide-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 350px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: blur(20px);
            box-shadow: 4px 0 24px rgba(212, 175, 55, 0.15);
            border-right: 2px solid rgba(212, 175, 55, 0.15);
            transition: left 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            padding-top: 20px;
        }

        .slide-menu.collapsed {
            left: -350px;
        }

        .menu-header {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            padding: 2rem 1.5rem 1.2rem 1.5rem;
            text-align: center;
            position: relative;
            z-index: 2;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 70px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.2);
        }

        .menu-bookmark-title {
            font-size: 1rem;
            font-weight: 600;
            opacity: 0.95;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .menu-content {
            padding: 1.5rem 1.5rem;
            position: relative;
            z-index: 2;
        }

        .menu-item {
            display: block;
            padding: 1.2rem 1rem;
            margin-bottom: 0.8rem;
            background: rgba(139, 69, 19, 0.06);
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
            border-left: 3px solid #8b4513;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(139, 69, 19, 0.1);
        }

        .menu-item:hover {
            background: rgba(139, 69, 19, 0.12);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.15);
            border-left-color: #d4af37;
        }

        .item-title {
            font-weight: 600;
            font-size: 0.95rem;
            margin: 0;
            color: #2c1810;
            letter-spacing: 0.2px;
        }

        /* Hero Section */
        .hero-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 2rem;
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .hero-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
        }

        .hero-subtitle {
            background: linear-gradient(135deg, #8b4513, #d4af37);
            color: white;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 1rem 0;
            display: inline-block;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .hero-description {
            font-size: 1.1rem;
            color: #666;
            max-width: 800px;
            margin: 0 auto 2rem;
            position: relative;
            z-index: 2;
        }

        /* Audio Section */
        .audio-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 8px 32px rgba(212, 175, 55, 0.15);
            border: 1px solid rgba(212, 175, 55, 0.15);
        }

        .audio-controls {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(139, 69, 19, 0.05);
            border-radius: 10px;
            border: 2px solid rgba(139, 69, 19, 0.1);
        }

        .audio-player {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .audio-btn {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }

        .audio-btn:hover {
            background: linear-gradient(135deg, #a0522d, #8b4513);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }

        .audio-btn:disabled {
            background: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .timer {
            font-size: 1.2rem;
            font-weight: bold;
            color: #8b4513;
            margin-top: 1rem;
        }

        .audio-info {
            background: rgba(255, 255, 255, 0.8);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid #d4af37;
        }

        .audio-info h4 {
            color: #8b4513;
            margin-bottom: 0.5rem;
        }

        /* Questions Section */
        .questions-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 8px 32px rgba(212, 175, 55, 0.15);
            border: 1px solid rgba(212, 175, 55, 0.15);
        }

        .section-title {
            text-align: center;
            font-size: 2rem;
            color: #8b4513;
            margin-bottom: 2rem;
            font-weight: bold;
        }

        .conversation-text {
            background: rgba(139, 69, 19, 0.05);
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            line-height: 1.8;
            font-size: 1.1rem;
            border-left: 4px solid #8b4513;
        }

        .speaker {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 0.5rem;
            display: block;
        }

        .question {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            border-left: 3px solid #d4af37;
        }

        .question-number {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 0.5rem;
        }

        .fill-blank {
            display: inline-block;
            width: 150px;
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .fill-blank:focus {
            outline: none;
            border-color: #8b4513;
            box-shadow: 0 0 5px rgba(139, 69, 19, 0.3);
        }

        .submit-section {
            text-align: center;
            margin-top: 2rem;
        }

        .submit-btn {
            background: linear-gradient(135deg, #DAA520, #B8860B);
            color: white;
            border: none;
            padding: 1rem 3rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(218, 165, 32, 0.4);
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, #B8860B, #CD853F);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(218, 165, 32, 0.5);
        }

        /* Results Section */
        .results-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 8px 32px rgba(212, 175, 55, 0.15);
            border: 1px solid rgba(212, 175, 55, 0.15);
            display: none;
        }

        .score-display {
            text-align: center;
            margin-bottom: 2rem;
        }

        .score-number {
            font-size: 3rem;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 0.5rem;
        }

        .score-text {
            font-size: 1.2rem;
            color: #666;
        }

        .answer-review {
            margin-bottom: 2rem;
        }

        .answer-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            gap: 1rem;
        }

        .answer-correct {
            border-left: 4px solid #28a745;
        }

        .answer-incorrect {
            border-left: 4px solid #dc3545;
        }

        .answer-icon {
            font-size: 1.5rem;
        }

        .answer-icon.correct {
            color: #28a745;
        }

        .answer-icon.incorrect {
            color: #dc3545;
        }

        .answer-details {
            flex: 1;
        }

        .answer-question {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .answer-explanation {
            font-size: 0.9rem;
            color: #666;
        }

        .improvement-tips {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid rgba(255, 193, 7, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .improvement-tips h4 {
            color: #8b4513;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .improvement-tips ul {
            list-style: none;
            padding-left: 0;
        }

        .improvement-tips li {
            margin-bottom: 0.5rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .improvement-tips li::before {
            content: "💡";
            position: absolute;
            left: 0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
                margin-top: 60px;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
                padding: 0.8rem 1.5rem;
            }

            .audio-player {
                flex-direction: column;
                gap: 0.5rem;
            }

            .container {
                margin-left: 320px;
            }

            .container.menu-collapsed {
                margin-left: 20px;
            }

            .menu-toggle {
                left: 320px;
                top: 100px;
            }

            .menu-toggle.collapsed {
                left: 20px;
            }

            .menu-toggle-label {
                left: 345px;
                top: 160px;
            }

            .menu-toggle-label.collapsed {
                left: 45px;
            }

            .gk-logo-container {
                top: 100px;
                right: 20px;
            }
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Master Guruvammal Logo as Back Button -->
    <div class="gk-logo-container" onclick="handleBackButton()" title="Back to Home">
        <div class="master-guruvammal-logo">
                                    Ga<span class="musical-corner">P</span>
        </div>
        <div class="back-label">Back</div>
    </div>

    <!-- Menu Toggle Button -->
    <button class="menu-toggle" onclick="toggleMenu()">
        <i class="fas fa-chevron-left"></i>
    </button>
    <div class="menu-toggle-label" id="menuToggleLabel">Collapse</div>

    <!-- Slide-out Menu -->
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <div class="menu-bookmark-title">IELTS Listening Practice Guide</div>
        </div>
        <div class="menu-content">
            <a href="#instructions" class="menu-item" onclick="navigateToSection('instructions')">
                <div class="item-title">1. Instructions</div>
            </a>
            <a href="#audio-section" class="menu-item" onclick="navigateToSection('audio-section')">
                <div class="item-title">2. Audio Conversation</div>
            </a>
            <a href="#questions" class="menu-item" onclick="navigateToSection('questions')">
                <div class="item-title">3. Questions (Part 1)</div>
            </a>
            <a href="#results" class="menu-item" onclick="navigateToSection('results')">
                <div class="item-title">4. Results & Analysis</div>
            </a>
        </div>
    </div>

    <!-- Header Spacer -->
    <div class="header-spacer"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Main Content -->
        <main class="main-content">
            <!-- Hero Section -->
            <section class="hero-section fade-in">
                <h1 class="hero-title">
                    IELTS General Listening - Part 1 (Practice 2)
                </h1>
                <div class="hero-subtitle">Practice Session - Library Membership Registration</div>
                <p class="hero-description">
                    This is a practice session for IELTS General Listening Part 1. You will hear a detailed conversation between 
                    Emma and the librarian about registering for a new library membership. The conversation includes 
                    realistic dialogue with natural pauses and explanations. Listen carefully and complete the registration form 
                    with short, specific answers. You have 6 minutes total - the conversation lasts about 4 minutes, giving you time to complete your answers.
                </p>
            </section>

            <!-- Instructions Section -->
            <section id="instructions" class="questions-section">
                <h2 class="section-title">
                    Practice Instructions
                </h2>
                <div class="audio-info">
                    <h4>Important Instructions:</h4>
                    <ul style="list-style: disc; margin-left: 2rem; line-height: 1.8;">
                        <li>You will hear a conversation between a new member and a librarian</li>
                        <li>The conversation will be played <strong>only once</strong></li>
                        <li>Listen carefully and fill in the missing information in the form below</li>
                        <li>Write ONE WORD ONLY for each answer</li>
                        <li>You have 10 questions to answer</li>
                        <li>After completing all answers, click "Submit Practice" to see your results</li>
                    </ul>
                </div>
            </section>

            <!-- Audio Section -->
            <section id="audio-section" class="audio-section">
                <h2 class="section-title">
                    Library Membership Registration
                </h2>
                
                <div class="audio-controls">
                    <div class="audio-info">
                        <h4>Audio Information:</h4>
                        <p>You will hear Emma registering for a new library membership at Central City Library. 
                        Listen to the conversation between Emma and the library staff member and complete the registration form below. 
                        The conversation features two distinct voices.</p>
                    </div>
                    
                    <div class="audio-player">
                        <button class="audio-btn" id="playBtn" onclick="playAudio()">
                            Play Audio
                        </button>
                    </div>
                    <div class="timer" id="timer">Time: 6:00</div>
                </div>
            </section>

            <!-- Questions Section -->
            <section id="questions" class="questions-section">
                <h2 class="section-title">
                    Complete the Library Registration Form
                </h2>
                
                <div class="conversation-text">
                    <h3 style="color: #8b4513; margin-bottom: 1.5rem;">CENTRAL CITY LIBRARY - MEMBERSHIP FORM</h3>
                    
                    <h4 style="color: #8b4513; margin: 1.5rem 0 1rem 0; font-size: 1.3rem; border-bottom: 2px solid #d4af37; padding-bottom: 0.5rem;">Personal Information</h4>
                    
                    <div class="question">
                        The member's surname is spelled as 1. <input type="text" class="fill-blank" id="q1">
                    </div>

                    <div class="question">
                        Her birth month is 2. <input type="text" class="fill-blank" id="q2">
                    </div>

                    <div class="question">
                        Her occupation is 3. <input type="text" class="fill-blank" id="q3">
                    </div>

                    <h4 style="color: #8b4513; margin: 1.5rem 0 1rem 0; font-size: 1.3rem; border-bottom: 2px solid #d4af37; padding-bottom: 0.5rem;">Address Details</h4>

                    <div class="question">
                        The type of street she lives on is Oak 4. <input type="text" class="fill-blank" id="q4">
                    </div>

                    <div class="question">
                        The area where she lives is 5. <input type="text" class="fill-blank" id="q5">
                    </div>

                    <h4 style="color: #8b4513; margin: 1.5rem 0 1rem 0; font-size: 1.3rem; border-bottom: 2px solid #d4af37; padding-bottom: 0.5rem;">Library Preferences</h4>

                    <div class="question">
                        Her primary interest for borrowing is 6. <input type="text" class="fill-blank" id="q6"> books
                    </div>

                    <div class="question">
                        She would prefer to receive library notifications by 7. <input type="text" class="fill-blank" id="q7">
                    </div>

                    <div class="question">
                        The membership type she chooses is 8. <input type="text" class="fill-blank" id="q8"> membership
                    </div>

                    <h4 style="color: #8b4513; margin: 1.5rem 0 1rem 0; font-size: 1.3rem; border-bottom: 2px solid #d4af37; padding-bottom: 0.5rem;">Additional Information</h4>

                    <div class="question">
                        She would like to attend the 9. <input type="text" class="fill-blank" id="q9"> workshop
                    </div>

                    <div class="question">
                        Her library card will be ready for collection on 10. <input type="text" class="fill-blank" id="q10">
                    </div>
                </div>

                <div class="submit-section">
                    <button class="submit-btn" onclick="submitTest()">
                        SUBMIT
                    </button>
                </div>
            </section>

            <!-- Results Section -->
            <section id="results" class="results-section">
                <h2 class="section-title">
                    Practice Results & Analysis
                </h2>
                
                <div class="score-display">
                    <div class="score-number" id="scoreNumber">0</div>
                    <div class="score-text">out of 10 questions correct</div>
                </div>

                <div class="answer-review" id="answerReview">
                    <!-- Answer review will be populated by JavaScript -->
                </div>

                <div class="improvement-tips">
                    <h4>Improvement Tips</h4>
                    <ul id="improvementList">
                        <!-- Tips will be populated by JavaScript -->
                    </ul>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Audio simulation and test data
        let audioContext = null;
        let isPlaying = false;
        let currentTime = 0;
                    let totalDuration = 360; // 6 minutes in seconds
        let audioInterval = null;

        // Correct answers for library registration
        const correctAnswers = {
            q1: 'thompson',
            q2: 'march',
            q3: 'teacher',
            q4: 'street',
            q5: 'wandsworth',
            q6: 'fiction',
            q7: 'email',
            q8: 'standard',
            q9: 'writing',
            q10: 'friday'
        };

        // Question explanations
        const explanations = {
            q1: 'Emma spells her surname as "T-H-O-M-P-S-O-N"',
            q2: 'Her birth month is "March"',
            q3: 'Emma mentions her occupation is "teacher"',
            q4: 'She lives on Oak "Street"',
            q5: 'She mentions she lives in the "Wandsworth" area',
            q6: 'She is most interested in borrowing "fiction books"',
            q7: 'She prefers to receive notifications by "email"',
            q8: 'She chooses "standard membership"',
            q9: 'She wants to attend the "writing workshop"',
            q10: 'Her library card will be ready on "Friday"'
        };

        // Menu functionality
        function toggleMenu() {
            const menu = document.getElementById('slideMenu');
            const toggleBtn = document.querySelector('.menu-toggle');
            const toggleLabel = document.getElementById('menuToggleLabel');
            const container = document.querySelector('.container');
            const isCollapsed = menu.classList.contains('collapsed');
            
            if (isCollapsed) {
                menu.classList.remove('collapsed');
                toggleBtn.classList.remove('collapsed');
                toggleLabel.classList.remove('collapsed');
                container.classList.remove('menu-collapsed');
                toggleBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                toggleLabel.textContent = 'Collapse';
            } else {
                menu.classList.add('collapsed');
                toggleBtn.classList.add('collapsed');
                toggleLabel.classList.add('collapsed');
                container.classList.add('menu-collapsed');
                toggleBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                toggleLabel.textContent = 'Expand';
            }
        }

        // Back button functionality - Firebase compatible
        function handleBackButton() {
            console.log('🔄 Back button clicked from IELTS Listening test');
            if (window.loadLanguageContent || window.parent.loadLanguageContent) {
                if (window.loadLanguageContent) {
                    window.loadLanguageContent('ielts', 'general');
                } else if (window.parent.loadLanguageContent) {
                    window.parent.loadLanguageContent('ielts', 'general');
                }
            } else {
                if (window.history.length > 1) {
                    window.history.back();
                } else {
                    window.location.href = '../../index.html';
                }
            }
        }

        // Navigation to sections
        function navigateToSection(sectionId) {
            const menu = document.getElementById('slideMenu');
            if (!menu.classList.contains('collapsed')) {
                toggleMenu();
            }
            scrollToSection(sectionId);
        }

        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // Internet Connection Check for Audio
        let hasShownOfflineMessage = false;

        function checkInternetForAudio() {
            // Only check basic online status - don't check voices availability
            if (!navigator.onLine) {
                alert('Check your network');
                return false;
            }
            return true;
        }

        function showOfflineMessage() {
            if (hasShownOfflineMessage) return;
            hasShownOfflineMessage = true;
            alert('🌐 Connect to internet or better network\n\n' +
                  'IELTS Listening audio requires an internet connection for the best speech quality.\n\n' +
                  '📡 Please check your internet connection and try again.');
            setTimeout(() => { hasShownOfflineMessage = false; }, 10000);
        }

        window.addEventListener('online', () => { hasShownOfflineMessage = false; });
        window.addEventListener('offline', () => { hasShownOfflineMessage = false; });

        // Audio functionality
        function playAudio() {
            console.log('🎵 Playing IELTS Listening audio...');
            
            if (!checkInternetForAudio()) {
                return;
            }
            
            // Auto-scroll to questions section when audio starts
            scrollToSection('questions');
            
            // Simulate audio with speech synthesis using different voices
            if ('speechSynthesis' in window) {
                playConversationWithTwoVoices();
            } else {
                alert('Audio simulation not available. In a real test, you would hear the conversation.');
            }
        }

        function playConversationWithTwoVoices() {
            // Wait for voices to load before starting
            if (speechSynthesis.getVoices().length === 0) {
                speechSynthesis.addEventListener('voiceschanged', playConversationWithTwoVoices, { once: true });
                return;
            }
            
            // Extended conversation designed to last about 4 minutes with 5-minute timer
            const conversation = [
                { speaker: 'librarian', text: 'Good afternoon, welcome to Central City Library. How can I help you today?', pause: 1200 },
                { speaker: 'emma', text: 'Hello! I\'d like to register for a library membership please. I\'ve just moved to the area and I\'m very excited to join your library. I heard you have an excellent collection.', pause: 1400 },
                { speaker: 'librarian', text: 'That\'s wonderful! We\'d be delighted to have you as a member. Let me get you signed up today. First, I\'ll need some basic personal information. Could you please tell me your full name?', pause: 1300 },
                { speaker: 'emma', text: 'Certainly! My first name is Emma, and my surname is Thompson. That\'s spelled T, H, O, M, P, S, O, N, like the famous writer.', pause: 1600 },
                { speaker: 'librarian', text: 'Perfect, Emma Thompson. Now, I\'ll need your date of birth for our records. This helps us determine which services you\'re eligible for.', pause: 1300 },
                { speaker: 'emma', text: 'Of course! I was born in March, 1995. March is my favorite month actually.', pause: 1400 },
                { speaker: 'librarian', text: 'Excellent, thank you. And what is your current occupation? We like to keep track of our community members.', pause: 1400 },
                { speaker: 'emma', text: 'Yes, I work as a teacher at the local primary school. It\'s a very rewarding job working with children.', pause: 1600 },
                { speaker: 'librarian', text: 'That\'s wonderful! Teachers are very important to our community. Now I\'ll need your current address. What\'s your street address?', pause: 1300 },
                { speaker: 'emma', text: 'I live on Oak Street. It\'s a lovely quiet street near the park. I really love living on a street rather than an avenue or road.', pause: 1500 },
                { speaker: 'librarian', text: 'Wonderful! Oak Street is in a great location. Which area of the city is that in?', pause: 1200 },
                { speaker: 'emma', text: 'That\'s in Wandsworth. It\'s a lovely area with lots of green spaces and good transport links.', pause: 1500 },
                { speaker: 'librarian', text: 'Perfect! Now let me tell you about our services. What type of materials are you most interested in borrowing from our collection?', pause: 1400 },
                { speaker: 'emma', text: 'I\'m primarily interested in fiction books. I love reading novels, especially contemporary fiction and classics. I go through about two or three books a week.', pause: 1600 },
                { speaker: 'librarian', text: 'That\'s fantastic! You\'ll love our fiction section. Now, how would you prefer to receive notifications about due dates, new arrivals, and library events?', pause: 1400 },
                { speaker: 'emma', text: 'Email would be perfect for me. I check my email regularly, and it\'s much more convenient than phone calls or postal mail.', pause: 1400 },
                { speaker: 'librarian', text: 'Excellent choice! Email notifications are very popular. Now, we offer different types of memberships. We have a basic membership and a standard membership with additional benefits. Which would you prefer?', pause: 1600 },
                { speaker: 'emma', text: 'What are the differences between them? I think the standard membership sounds good if it has more benefits.', pause: 1400 },
                { speaker: 'librarian', text: 'Great choice! The standard membership includes longer borrowing periods, access to our digital collection, and priority booking for events. Speaking of events, we have various workshops and programs. Are you interested in any particular activities?', pause: 1800 },
                { speaker: 'emma', text: 'That sounds wonderful! I\'m particularly interested in creative activities. Do you have any writing workshops? I\'ve always wanted to improve my creative writing skills.', pause: 1600 },
                { speaker: 'librarian', text: 'Perfect timing! We have a creative writing workshop that meets every Thursday evening. I\'ll put your name down for that. Your membership application is now complete, Emma.', pause: 1600 },
                { speaker: 'emma', text: 'That\'s excellent! When will my library card be ready for collection?', pause: 1200 },
                { speaker: 'librarian', text: 'Your library card will be ready for collection on Friday. You can pick it up anytime after 10 AM, and then you can start borrowing immediately.', pause: 1400 },
                { speaker: 'emma', text: 'Perfect! Thank you so much for all your help. I\'m really looking forward to being a member here.', pause: 1200 },
                { speaker: 'librarian', text: 'You\'re very welcome, Emma! We\'re delighted to have you join our library community. See you on Friday!', pause: 1000 }
            ];

            let currentIndex = 0;
            let startTime = Date.now();

            function playNextLine() {
                // Allow conversation to complete naturally
                // The timer will handle the 5-minute limit separately

                if (currentIndex >= conversation.length) {
                    // Conversation finished naturally
                    isPlaying = false;
                    updateAudioControls();
                    return;
                }

                const line = conversation[currentIndex];
                const utterance = new SpeechSynthesisUtterance(line.text);
                
                // Set different voice characteristics for each speaker
                if (line.speaker === 'emma') {
                    // Emma - Member voice (male)
                    // Slow down for spelling
                    if (line.text.includes('T, H, O, M, P, S, O, N')) {
                        utterance.rate = 0.6;
                    } else {
                        utterance.rate = 0.8;
                    }
                    utterance.pitch = 0.9;
                    utterance.volume = 0.8;
                    
                    // Try to find an Australian male voice
                    const voices = speechSynthesis.getVoices();
                    const maleVoice = voices.find(voice => 
                        voice.lang.includes('en-AU') ||
                        voice.name.toLowerCase().includes('australian') ||
                        voice.name.toLowerCase().includes('australia') ||
                        voice.name.toLowerCase().includes('james') ||
                        voice.name.toLowerCase().includes('russell') ||
                        (voice.lang.startsWith('en') && voice.name.toLowerCase().includes('male'))
                    ) || voices.find(voice => voice.name.toLowerCase().includes('male'));
                    if (maleVoice) utterance.voice = maleVoice;
                } else {
                    // Librarian - Professional female voice
                    utterance.rate = 0.75;
                    utterance.pitch = 1.1;
                    utterance.volume = 0.8;
                    
                    // Try to find an Australian female voice for librarian
                    const voices = speechSynthesis.getVoices();
                    const professionalVoice = voices.find(voice => 
                        voice.lang.includes('en-AU') ||
                        voice.name.toLowerCase().includes('australian') ||
                        voice.name.toLowerCase().includes('australia') ||
                        voice.name.toLowerCase().includes('nicole') ||
                        voice.name.toLowerCase().includes('catherine') ||
                        (voice.lang.startsWith('en') && voice.name.toLowerCase().includes('karen'))
                    ) || voices.find(voice => voice.name.toLowerCase().includes('female'));
                    if (professionalVoice) utterance.voice = professionalVoice;
                }

                utterance.onstart = () => {
                    if (currentIndex === 0) {
                        isPlaying = true;
                        updateAudioControls();
                        startTimer();
                    }
                };

                utterance.onend = () => {
                    currentIndex++;
                    // Use the specified pause time for each line
                    const pauseTime = line.pause || 1500;
                    setTimeout(playNextLine, pauseTime);
                };

                utterance.onerror = () => {
                    currentIndex++;
                    const pauseTime = line.pause || 1500;
                    setTimeout(playNextLine, pauseTime);
                };

                // Check network connection before speaking
                if (!navigator.onLine) {
                    alert('Check your network');
                    return;
                }
                speechSynthesis.speak(utterance);
            }

            // Start the conversation
            playNextLine();
        }

        // Show popup when audio is complete
        function showSubmitPopup() {
            alert("Time's up! Your practice session will now be submitted for scoring.");
            submitTest();
        }

        function updateAudioControls() {
            const playBtn = document.getElementById('playBtn');
            playBtn.disabled = isPlaying;
        }

        function startTimer() {
            audioInterval = setInterval(() => {
                currentTime++;
                updateTimerDisplay();
                if (currentTime >= totalDuration) {
                    stopTimer();
                    showSubmitPopup();
                }
            }, 1000);
        }

        function stopTimer() {
            if (audioInterval) {
                clearInterval(audioInterval);
                audioInterval = null;
            }
        }

        function updateTimerDisplay() {
            const timer = document.getElementById('timer');
            const remainingTime = totalDuration - currentTime;
            const minutes = Math.floor(remainingTime / 60);
            const seconds = remainingTime % 60;
            timer.textContent = `Time: ${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // Test submission and scoring
        function submitTest() {
            const userAnswers = {};
            let correctCount = 0;

            // Collect user answers
            for (let i = 1; i <= 10; i++) {
                const input = document.getElementById(`q${i}`);
                const userAnswer = input.value.toLowerCase().trim();
                userAnswers[`q${i}`] = userAnswer;
                
                if (userAnswer === correctAnswers[`q${i}`]) {
                    correctCount++;
                }
            }

            // Display results
            displayResults(correctCount, userAnswers);
            
            // Show results section
            document.getElementById('results').style.display = 'block';
            scrollToSection('results');
        }

        function displayResults(score, userAnswers) {
            // Update score display
            document.getElementById('scoreNumber').textContent = score;
            
            // Generate answer review
            const reviewContainer = document.getElementById('answerReview');
            reviewContainer.innerHTML = '';
            
            for (let i = 1; i <= 10; i++) {
                const questionKey = `q${i}`;
                const userAnswer = userAnswers[questionKey];
                const correctAnswer = correctAnswers[questionKey];
                const isCorrect = userAnswer === correctAnswer;
                
                const answerItem = document.createElement('div');
                answerItem.className = `answer-item ${isCorrect ? 'answer-correct' : 'answer-incorrect'}`;
                
                answerItem.innerHTML = `
                    <div class="answer-icon ${isCorrect ? 'correct' : 'incorrect'}">
                        <i class="fas ${isCorrect ? 'fa-check-circle' : 'fa-times-circle'}"></i>
                    </div>
                    <div class="answer-details">
                        <div class="answer-question">Question ${i}: ${isCorrect ? 'Correct' : 'Incorrect'}</div>
                        <div class="answer-explanation">
                            ${isCorrect ? 
                                `Your answer: "${userAnswer}" ✓` : 
                                `Your answer: "${userAnswer}" | Correct answer: "${correctAnswer}"`
                            }
                            <br>${explanations[questionKey]}
                        </div>
                    </div>
                `;
                
                reviewContainer.appendChild(answerItem);
            }
            
            // Generate improvement tips
            generateImprovementTips(score);
        }

        function generateImprovementTips(score) {
            const tipsContainer = document.getElementById('improvementList');
            tipsContainer.innerHTML = '';
            
            const tips = [];
            
            if (score === 10) {
                tips.push('Excellent work! You have perfect listening comprehension skills.');
                tips.push('Continue practicing with more complex listening materials.');
                tips.push('Try IELTS Part 2-4 for greater challenges.');
            } else if (score >= 8) {
                tips.push('Great job! Your listening skills are very strong.');
                tips.push('Focus on spelling accuracy for the answers you missed.');
                tips.push('Practice note-taking while listening to improve speed.');
            } else if (score >= 6) {
                tips.push('Good progress! You understand most of the conversation.');
                tips.push('Work on identifying key information like numbers, dates, and names.');
                tips.push('Practice listening to different accents and speaking speeds.');
            } else if (score >= 4) {
                tips.push('You\'re developing your listening skills. Keep practicing!');
                tips.push('Focus on basic information: names, numbers, and simple facts.');
                tips.push('Listen to English conversations daily to improve comprehension.');
            } else {
                tips.push('Don\'t worry - listening skills improve with practice!');
                tips.push('Start with shorter, simpler conversations.');
                tips.push('Focus on one piece of information at a time.');
                tips.push('Practice with subtitles first, then without.');
            }
            
            tips.forEach(tip => {
                const li = document.createElement('li');
                li.textContent = tip;
                tipsContainer.appendChild(li);
            });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            console.log('IELTS General Listening Part 1 Practice 2 loaded successfully');
            updateAudioControls();
            updateTimerDisplay();
            
            // Disable spellcheck for all fill-blank inputs
            const fillBlankInputs = document.querySelectorAll('.fill-blank');
            fillBlankInputs.forEach(input => {
                input.setAttribute('spellcheck', 'false');
                input.setAttribute('autocomplete', 'off');
            });
            
            // Initialize toggle label
            const menu = document.getElementById('slideMenu');
            const toggleLabel = document.getElementById('menuToggleLabel');
            if (menu.classList.contains('collapsed')) {
                toggleLabel.textContent = 'Expand';
            } else {
                toggleLabel.textContent = 'Collapse';
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const menu = document.getElementById('slideMenu');
                if (!menu.classList.contains('collapsed')) {
                    toggleMenu();
                }
            }
        });

        // Ensure functions are globally accessible for Firebase compatibility
        window.handleBackButton = handleBackButton;
        window.playAudio = playAudio;
        window.toggleMenu = toggleMenu;
        window.navigateToSection = navigateToSection;
        window.scrollToSection = scrollToSection;
        window.submitAnswers = submitAnswers;
        window.checkInternetForAudio = checkInternetForAudio;
        window.showOfflineMessage = showOfflineMessage;
    </script>
</body>
</html> 